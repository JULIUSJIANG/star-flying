function Initial(){DisUtil.initial(),HitModel.initial();var t=[HitObject,HitObjectContainer,WorldObject,Light1,BulletO1,O1,UnionO,Blue,O1Dot];t.forEach(function(t){t.store=NorUtil.getStore(t)})}var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);i.prototype=e.prototype,t.prototype=new i},__awaiter=this&&this.__awaiter||function(t,e,i,r){return new(i||(i=Promise))(function(o,n){function a(t){try{h(r.next(t))}catch(e){n(e)}}function s(t){try{h(r["throw"](t))}catch(e){n(e)}}function h(t){t.done?o(t.value):new i(function(e){e(t.value)}).then(a,s)}h((r=r.apply(t,e||[])).next())})},__generator=this&&this.__generator||function(t,e){function i(t){return function(e){return r([t,e])}}function r(i){if(o)throw new TypeError("Generator is already executing.");for(;h;)try{if(o=1,n&&(a=n[2&i[0]?"return":i[0]?"throw":"next"])&&!(a=a.call(n,i[1])).done)return a;switch(n=0,a&&(i=[0,a.value]),i[0]){case 0:case 1:a=i;break;case 4:return h.label++,{value:i[1],done:!1};case 5:h.label++,n=i[1],i=[0];continue;case 7:i=h.ops.pop(),h.trys.pop();continue;default:if(a=h.trys,!(a=a.length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){h=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){h.label=i[1];break}if(6===i[0]&&h.label<a[1]){h.label=a[1],a=i;break}if(a&&h.label<a[2]){h.label=a[2],h.ops.push(i);break}a[2]&&h.ops.pop(),h.trys.pop();continue}i=e.call(t,h)}catch(r){i=[6,r],n=0}finally{o=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var o,n,a,s,h={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:i(0),"throw":i(1),"return":i(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},__assign=this&&this.__assign||Object.assign||function(t){for(var e,i=1,r=arguments.length;r>i;i++){e=arguments[i];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},HitObject=function(){function t(){this.store=t.store,this.size={width:0,height:0},this.formation=HitWorldFormation.netural,this.type=HitWorldType.netural,this.hitShapes=new Array,this.behavior=Behavior.getInstance(),this.isAlive=!0}return t.prototype.set=function(t){this.isAlive=!0},t.prototype.clear=function(){this.miss()},Object.defineProperty(t.prototype,"world",{get:function(){return this._world},set:function(t){this._world=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"x",{get:function(){return this.display.x},set:function(t){this.display.x=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this.display.y},set:function(t){this.display.y=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rotation",{get:function(){return this.display.rotation},set:function(t){this.display.rotation=t},enumerable:!0,configurable:!0}),t.prototype.hitOther=function(t){this.beingHit()},t.prototype.beingHit=function(){},t.prototype.getDisplay=function(){return this.display},t.prototype.getFor=function(){return this.formation},t.prototype.getType=function(){return this.type},t.prototype.getHitShapes=function(t,e){void 0===t&&(t={x:0,y:0}),void 0===e&&(e=0);var i=t.x,r=t.y,o=NorUtil.getRotate({x:this.x,y:this.y},e),n=NorUtil.getRotateCoe(e);return this.updateHitShapesByCoe({x:i+o.x,y:r+o.y},n),this.hitShapes},t.prototype.updateHitShapes=function(t,e){var i=t.x,r=t.y;this.hitShapes.forEach(function(t){t.update({x:i,y:r},e)})},t.prototype.updateHitShapesByCoe=function(t,e){var i=t.x,r=t.y;this.hitShapes.forEach(function(t){t.updateByCoe({x:i,y:r},e)})},t.prototype.miss=function(){this.isAlive&&(this.isAlive=!1,this.sleep(),this.parent?this.parent.removeChild(this):this.world.removeObj(this),this.behavior.stop(),egret.Tween.removeTweens(this),this.store.recovery(this),this.parent&&this.parent.getInfo())},t.prototype.setBehavior=function(t,e){this.behavior=new t(this,e)},t.prototype.go=function(t){this.wakeUp(),this.behavior.start()},t.prototype.wakeUp=function(){this.aliveDistance&&this.alive(),this.attackDistance&&this.attack()},t.prototype.sleep=function(){egret.clearTimeout(this.aliveTimeout),egret.clearTimeout(this.attackTimeout)},t.prototype.alive=function(){var t=this;this.onAlive(),this.aliveTimeout=egret.setTimeout(function(){t.alive()},this,this.aliveDistance)},t.prototype.onAlive=function(){},t.prototype.attack=function(){var t=this;this.onAttack(),this.attackTimeout=egret.setTimeout(function(){t.attack()},this,this.attackDistance)},t.prototype.onAttack=function(){},t.prototype.getWorldDot=function(){for(var t=this.getDisplay(),e=this.world,i={location:{x:t.x,y:t.y},rotation:t.rotation};t.parent!=e;)t=t.parent,i.location=NorUtil.getRotate(i.location,t.rotation),i.location.x+=t.x,i.location.y+=t.y,i.rotation+=t.rotation;return i},t.count=0,t}();__reflect(HitObject.prototype,"HitObject",["Product"]);var Behavior=function(){function t(t,e){this.hitObj=t,this.setData(e)}return t.getInstance=function(){return t.instance},t.prototype.setData=function(t){this.data=t},t.prototype.start=function(){},t.prototype.stop=function(){egret.Tween.removeTweens(this.hitObj)},t.prototype.pause=function(){},t.prototype["continue"]=function(){},t.instance=new t(null),t}();__reflect(Behavior.prototype,"Behavior");var Controler=function(){function t(){this.dummys=[]}return t.prototype.connect=function(t){this.dummys.push(t)},t.prototype.disConnect=function(t){this.dummys.splice(this.dummys.indexOf(t),1)},t.prototype.dispatch=function(t){this.dummys.forEach(function(e){e.getDispatch(t)})},t.prototype.getRespond=function(t){},t}();__reflect(Controler.prototype,"Controler");var Dummy=function(){function t(t){this.setControler(t)}return t.prototype.setControler=function(t){this.controler&&this.controler.disConnect(this),t.connect(this),this.controler=t},t.prototype.getDispatch=function(t){this.respond(this.update(t))},t.prototype.respond=function(t){this.controler.getRespond(t)},t}();__reflect(Dummy.prototype,"Dummy");var HitObjectContainer=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.store=e.store,i.display=new egret.Sprite,i.children=new Array,i}return __extends(e,t),e.prototype.clear=function(){this.children=[]},e.prototype.miss=function(){for(var e=0,i=this.children;e<i.length;e++){var r=i[e];r.miss()}t.prototype.miss.call(this)},e.prototype.addChild=function(t){t.world=this.world,t.parent=this,this.display.addChild(t.getDisplay()),this.children.push(t)},e.prototype.removeChild=function(t){this.display.removeChild(t.getDisplay()),this.children.splice(this.children.indexOf(t),1),t.parent=null},Object.defineProperty(e.prototype,"world",{get:function(){return this._world},set:function(t){this._world=t,this.children.forEach(function(e){e.world=t})},enumerable:!0,configurable:!0}),e.prototype.getHitShapes=function(t,e){void 0===t&&(t={x:0,y:0}),void 0===e&&(e=0);var i=t.x,r=t.y,o=NorUtil.getRotate({x:this.x,y:this.y},e);return this.updateHitShapes({x:i+o.x,y:r+o.y},this.rotation+e),this.hitShapes},e.prototype.updateHitShapes=function(t,e){var i=t.x,r=t.y;this.hitShapes=[].concat.apply([],this.children.map(function(t){return t.getHitShapes({x:i,y:r},e)}))},e.prototype.go=function(){t.prototype.go.call(this),this.children.forEach(function(t){t.go()})},e.prototype.getInfo=function(t){},e}(HitObject);__reflect(HitObjectContainer.prototype,"HitObjectContainer");var WorldObject=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.store=e.store,i.damage=0,i.life=0,i}return __extends(e,t),e.prototype.deCline=function(t){this.life-=t,this.life<=0&&this.destroy()},e.prototype.hitOther=function(e){t.prototype.hitOther.call(this,e),e.deCline(this.damage)},e.prototype.destroy=function(){this.miss()},e}(HitObject);__reflect(WorldObject.prototype,"WorldObject");var HitModel=function(){function t(t,e){this.type=t,this.set(e)}return t.initial=function(){for(var e=[[HitUtil.hitDotDot,HitUtil.hitDotCircle,HitUtil.hitDotCon],[null,HitUtil.hitCirCir,HitUtil.hitCirCon],[null,null,HitUtil.hitConCon]],i=0;i<e.length;i++){t[i]=[];for(var r=0;r<e.length;r++)t[i][r]=e[i][r]}for(var o=function(i){for(var r=function(r){t[i][r]=function(t,o){return e[r][i].call(null,o,t)}},o=0;i>o;o++)r(o)},i=1;i<e.length;i++)o(i)},t.hitTestModel=function(t,e){return this[t.type][e.type](t.moment,e.moment)},t.hitTestModels=function(e,i){for(var r=!1,o=0,n=e;o<n.length;o++)for(var a=n[o],s=0,h=i;s<h.length;s++){var c=h[s];if(r=t.hitTestModel(a,c))return!0}return!1},t}();__reflect(HitModel.prototype,"HitModel");var Light1=function(t){function e(i){var r=t.call(this)||this;return r.store=e.getStore(),r.size={width:14,height:41},r.type=HitWorldType.bullet,r.defaultBehavior=FlyEnd.getInstance(),r.aliveDistance=12,r.behavior=new FlyEnd(r,{speed:2}),r.formation=i,r.initial(),r}return __extends(e,t),e.getStore=function(){var t=e.store;return{recovery:function(e){t.recovery(e)},getInstance:function(e){return t.getInstance(e)}}},e.prototype.clear=function(){this.life=0},e.prototype.set=function(e){t.prototype.set.call(this,e),this.formation=e},e.prototype.initial=function(){this.hitShapes.push(new HitShape(this,new HitDot([-this.size.width/2,-this.size.height/2]),new HitDot([this.size.width/2,-this.size.height/2]),new HitDot([this.size.width/2,this.size.height/2]),new HitDot([-this.size.width/2,this.size.height/2])));var t=DisUtil.createBitmap("nor_png");DisUtil.anchorCenter(t),this.display=t},e.prototype.go=function(){t.prototype.go.call(this)},e.prototype.onAlive=function(){Shadow.getInstance("nor_shadow_png").playNormal({x:this.x,y:this.y},this.world,100,Index.BOTTOM,AnimationUnit.mini)},e.prototype.destroy=function(){Explode.getInstance("dot_hero_png").playNormal({x:this.x,y:this.y-this.size.height/2},this.world,200,30),t.prototype.destroy.call(this)},e}(WorldObject);__reflect(Light1.prototype,"Light1",["Product"]);var DebugPlatform=function(){function t(){}return t.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,{nickName:"username"}]})})},t.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);var Router=function(t){function e(){var e=t.call(this)||this;return e.playLimitless=new PlayLimitless,e.start(),e}return __extends(e,t),e.prototype.start=function(){this.addChild(this.playLimitless),this.playLimitless.start()},e}(egret.DisplayObjectContainer);__reflect(Router.prototype,"Router");var DirectHor;!function(t){t[t.LEFT=0]="LEFT",t[t.CENTER=1]="CENTER",t[t.RIGHT=2]="RIGHT"}(DirectHor||(DirectHor={}));var DirectVer;!function(t){t[t.TOP=0]="TOP",t[t.MIDDLE=1]="MIDDLE",t[t.BOTTOM=2]="BOTTOM"}(DirectVer||(DirectVer={}));var AnimationBase=function(){function t(t){this.display=t}return t.prototype.getDisplay=function(){return this.display},t.prototype.play=function(t,e,i,r,o){for(var n=this,a=t.x,s=t.y,h=[],c=5;c<arguments.length;c++)h[c-5]=arguments[c];var l={},u={};return h.forEach(function(t){l=__assign({},l,t.endStatus),u=__assign({},u,t.resultStatus)}),DisUtil.location(this.display,a,s),i==Index.BOTTOM?e.addChildAt(this.display,0):e.addChild(this.display),new Promise(function(t){egret.Tween.get(n.display).to(l,r,o).to(u).call(function(){e.removeChild(n.display),t()})})},t}();__reflect(AnimationBase.prototype,"AnimationBase");var AnimationUnit=function(){function t(t,e){this.endStatus=t,this.resultStatus=e}return t.fadeIn=new t({alpha:1},{alpha:0}),t.fadeout=new t({alpha:0},{alpha:1}),t.large=new t({scaleX:1.5,scaleY:1.5},{scaleX:1,scaleY:1}),t.mini=new t({scaleX:.5,scaleY:.5},{scaleX:1,scaleY:1}),t}();__reflect(AnimationUnit.prototype,"AnimationUnit");var HitShape=function(){function t(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];this.hitModels=new Array,this.reflector=t,this.hitModels=e}return t.testHits=function(e,i){for(var r=0,o=e;r<o.length;r++)for(var n=o[r],a=0,s=i;a<s.length;a++){var h=s[a];t.testHit(n,h)}},t.testHit=function(t,e){if(HitModel.hitTestModels(t.hitModels,e.hitModels)){var i=t.reflector,r=e.reflector;i.hitOther(r),r.hitOther(i)}},t.prototype.getHitModels=function(){return this.hitModels},t.prototype.update=function(t,e){var i=t.x,r=t.y;this.hitModels.forEach(function(t){t.update({x:i,y:r},e)})},t.prototype.updateByCoe=function(t,e){var i=t.x,r=t.y;this.hitModels.forEach(function(t){t.updateByCoe({x:i,y:r},e)})},t.prototype.addUnit=function(t){this.hitModels.push(t)},t.prototype.removeUnit=function(t){this.hitModels.splice(this.hitModels.indexOf(t),1)},t}();__reflect(HitShape.prototype,"HitShape");var HitWorldFormation;!function(t){t[t.army=0]="army",t[t.enemy=1]="enemy",t[t.netural=2]="netural"}(HitWorldFormation||(HitWorldFormation={}));var HitWorldType;!function(t){t[t.bullet=0]="bullet",t[t.damage=1]="damage",t[t.netural=2]="netural"}(HitWorldType||(HitWorldType={}));var Index;!function(t){t[t.TOP=0]="TOP",t[t.BOTTOM=1]="BOTTOM"}(Index||(Index={}));var HitWorld=function(t){function e(e,i){var r=t.call(this)||this;return r.manager=[],DisUtil.size(r,e,i),r.manager[HitWorldFormation.army]=[],r.manager[HitWorldFormation.army][HitWorldType.damage]=[],r.manager[HitWorldFormation.army][HitWorldType.bullet]=[],r.manager[HitWorldFormation.enemy]=[],r.manager[HitWorldFormation.enemy][HitWorldType.damage]=[],r.manager[HitWorldFormation.enemy][HitWorldType.bullet]=[],r}return __extends(e,t),e.prototype.start=function(){var t=this;console.log("start"),egret.setInterval(function(){t.hitTest({formation:HitWorldFormation.army,type:HitWorldType.bullet},{formation:HitWorldFormation.enemy,type:HitWorldType.damage})},this,10),egret.setInterval(function(){},this,10),egret.setInterval(function(){},this,10),egret.setInterval(function(){},this,10)},e.prototype.addObj=function(t){this.addChildAt(t.getDisplay(),0),this.manager[t.getFor()][t.getType()].push(t),t.world=this},e.prototype.removeObj=function(t){t.world=null;var e=this,i=e.manager[t.getFor()][t.getType()],r=i.indexOf(t);i.splice(r,1),this.removeChild(t.getDisplay())},e.prototype.hitTest=function(t,e){var i=this.manager[t.formation][t.type],r=this.manager[e.formation][e.type],o=[].concat.apply([],i.map(function(t){return t.getHitShapes()})),n=[].concat.apply([],r.map(function(t){return t.getHitShapes()}));HitShape.testHits(o,n)},e}(egret.DisplayObjectContainer);__reflect(HitWorld.prototype,"HitWorld");var Explode=function(){function t(t){this.animationBases=[],this.textureName=t;for(var e=3;e--;){var i=DisUtil.createBitmap(t);DisUtil.anchorCenter(i),this.animationBases.push(new AnimationBase(i))}}return t.prototype.clear=function(){},t.prototype.set=function(){},t.recovery=function(e){t.category[e.textureName]||(t.category[e.textureName]=NorUtil.getStore(t)),t.category[e.textureName].recovery(e)},t.getInstance=function(e){var i=t.category[e];return i&&i.getInstance(e)||new t(e)},t.prototype.playNormal=function(e,i,r,o){for(var n=this,a=e.x,s=e.y,h=[],c=4;c<arguments.length;c++)h[c-4]=arguments[c];this.animationBases.forEach(function(t){var e=(1*Math.random()-.5)*o,n=(1*Math.random()-.5)*o;t.play.apply(t,[{x:a+e,y:s+n},i,Index.TOP,r,null,AnimationUnit.fadeout].concat(h))}),egret.setTimeout(function(){t.recovery(n)},this,r)},t.category=[],t}();__reflect(Explode.prototype,"Explode");var Shadow=function(){function t(t){this.textureName=t;var e=DisUtil.createBitmap(t);DisUtil.anchorCenter(e),this.animationBase=new AnimationBase(e)}return t.prototype.clear=function(){},t.prototype.set=function(){},t.recovery=function(e){t.category[e.textureName]||(t.category[e.textureName]=NorUtil.getStore(t)),t.category[e.textureName].recovery(e)},t.getInstance=function(e){var i=t.category[e];return i&&i.getInstance(e)||new t(e)},t.prototype.playNormal=function(e,i,r,o){var n=this,a=e.x,s=e.y;void 0===o&&(o=Index.BOTTOM);for(var h=[],c=4;c<arguments.length;c++)h[c-4]=arguments[c];(l=this.animationBase).play.apply(l,[{x:a,y:s},i,o,r,null,AnimationUnit.fadeout].concat(h)).then(function(){t.recovery(n)});var l},t.category=[],t}();__reflect(Shadow.prototype,"Shadow",["Product"]);var FlyAroundArmy=function(t){function e(e,i){return void 0===i&&(i={timeDistance:2e3,radius:400,angle:2*Math.PI/3}),t.call(this,e,i)||this}return __extends(e,t),e.prototype.setData=function(t){e=[t.timeDistance,t.radius,t.angle],this.timeDistance=e[0],this.radius=e[1],this.angle=e[2],this.baseAngle=(Math.PI-this.angle)/2;var e},e.prototype.start=function(){var t=this;this.onAround(),this.focusTimeout=egret.setTimeout(function(){t.start()},this,this.timeDistance)},e.prototype.stop=function(){egret.clearTimeout(this.focusTimeout)},e.prototype.pause=function(){this.stop()},e.prototype["continue"]=function(){this["continue"]()},e.prototype.onAround=function(){var t=this.hitObj.world.manager[HitWorldFormation.army][HitWorldType.damage][0],e=Math.random()*this.angle+this.baseAngle,i=Math.PI/2-e,r=t.x+Math.cos(e)*this.radius,o=t.y-Math.sin(e)*this.radius;egret.Tween.removeTweens(this),egret.Tween.get(this.hitObj).to({x:r,y:o},this.timeDistance,egret.Ease.quadInOut),egret.Tween.get(this.hitObj).to({rotation:NorUtil.pIToNum(i)/Math.PI},this.timeDistance,egret.Ease.quadInOut)},e}(Behavior);__reflect(FlyAroundArmy.prototype,"FlyAroundArmy");var FlyCircle=function(t){function e(e,i){return void 0===i&&(i={beginAngle:0,totalTime:4e3,radius:100}),t.call(this,e,i)||this}return __extends(e,t),e.prototype.setData=function(e){t.prototype.setData.call(this,e),i=[e.beginAngle,e.totalTime,e.radius],this.beginAngle=i[0],this.totalTime=i[1],this.radius=i[2];var i},Object.defineProperty(e.prototype,"angle",{get:function(){return this._angle},set:function(t){var e=this;e._angle=t,e.hitObj.x=Math.cos(t)*e.radius,e.hitObj.y=Math.sin(t)*e.radius},enumerable:!0,configurable:!0}),e.prototype.start=function(){this.tween=egret.Tween.get(this,{loop:!0}).to({angle:this.beginAngle}).to({angle:this.beginAngle+2*Math.PI},this.totalTime)},e.prototype.pause=function(){this.tween.pause()},e.prototype["continue"]=function(){this.tween.play()},e}(Behavior);__reflect(FlyCircle.prototype,"FlyCircle");var FlyEnd=function(t){function e(e,i){return void 0===i&&(i={speed:2}),t.call(this,e,i)||this}return __extends(e,t),e.prototype.start=function(){var t=this.hitObj,e=this.data.speed,i=-t.size.height/2,r=t.y-i,o=r/e;this.tween=egret.Tween.get(t).to({y:i},o).call(function(){t.miss()})},e.prototype.stop=function(){},e.prototype.pause=function(){this.tween.pause()},e.prototype["continue"]=function(){this.tween.play()},e}(Behavior);__reflect(FlyEnd.prototype,"FlyEnd");var FlyToArmy=function(t){function e(e,i){return void 0===i&&(i={speed:1}),t.call(this,e,i)||this}return __extends(e,t),e.prototype.setData=function(t){this.speed=t.speed},e.prototype.start=function(){var t,e,i,r,o=this,n={x:this.hitObj.x,y:this.hitObj.y},a=this.hitObj.world.manager[HitWorldFormation.army][HitWorldType.damage][0],s={x:a.x,y:a.y},h=this.hitObj.world,c=this.hitObj.size.width/2,l=Line.getLine({x:n.x,y:n.y},s);s.x>n.x?(e=h.width,i=1):(e=0,i=-1);var u,p=l.getY(e);p>=0&&p<=h.height?(e+=c*i,u=l.getY(e)):(u=s.y>n.y?h.height+c:-c,e=l.getX(u)),t=Math.sqrt(Math.pow(e-n.x,2)+Math.pow(u-n.y,2)),r=t/this.speed,this.tween=egret.Tween.get(this.hitObj).to({x:e,y:u},r).call(function(){o.hitObj.miss()})},e.prototype.pause=function(){this.tween.pause()},e.prototype["continue"]=function(){this.tween.play()},e}(Behavior);__reflect(FlyToArmy.prototype,"FlyToArmy");var BulletO1=function(t){function e(i){var r=t.call(this)||this;return r.store=e.store,r.type=HitWorldType.bullet,r.aliveDistance=50,r.formation=i,r.behavior=new FlyToArmy(r,{speed:.5}),r.initial(),r}return __extends(e,t),e.prototype.initial=function(){var t=DisUtil.createBitmap("o1_base2_png");DisUtil.anchorCenter(t),this.display=t},e.prototype.onAlive=function(){var t=this.getWorldDot();Shadow.getInstance("o1_png").playNormal(t.location,this.world,200,Index.BOTTOM,AnimationUnit.mini)},e}(WorldObject);__reflect(BulletO1.prototype,"BulletO1");var Main=function(t){function e(){var e=t.call(this)||this;return e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onAddToStage,e),e}return __extends(e,t),e.prototype.onAddToStage=function(t){egret.lifecycle.addLifecycleListener(function(t){t.onUpdate=function(){}}),egret.lifecycle.onPause=function(){egret.ticker.pause()},egret.lifecycle.onResume=function(){egret.ticker.resume()},this.runGame()["catch"](function(t){console.log(t)})},e.prototype.runGame=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return[4,this.loadResource()];case 1:return e.sent(),this.createGameScene(),[4,platform.login()];case 2:return e.sent(),[4,platform.getUserInfo()];case 3:return t=e.sent(),console.log(t),[2]}})})},e.prototype.loadResource=function(){return __awaiter(this,void 0,void 0,function(){var t,e;return __generator(this,function(i){switch(i.label){case 0:return i.trys.push([0,3,,4]),t=new LoadingUI,this.stage.addChild(t),[4,RES.loadConfig("resource/default.res.json","resource/")];case 1:return i.sent(),[4,RES.loadGroup("preload",0,t)];case 2:return i.sent(),this.stage.removeChild(t),[3,4];case 3:return e=i.sent(),console.error(e),[3,4];case 4:return[2]}})})},e.prototype.createGameScene=function(){Initial(),egret.Bitmap.defaultSmoothing=!1,this.addChild(new Router)},e}(egret.DisplayObjectContainer);__reflect(Main.prototype,"Main");var DragControler=function(t){function e(e,i){var r=t.call(this)||this;return r.width=e,r.height=i,r.board=new egret.Shape,r.vector={x:0,y:0},r.pointRecord={x:0,y:0},r.initial(),r.listen(),r}return __extends(e,t),e.prototype.getToucher=function(){return this.board},e.prototype.initial=function(){DisUtil.size(this.board,this.width,this.height);var t=this.board.graphics;t.beginFill(16777215,0),t.drawRect(0,0,this.width,this.height),t.endFill()},e.prototype.listen=function(){this.board.touchEnabled=!0,this.board.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.touchBegin,this),this.board.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.touchMove,this)},e.prototype.getRespond=function(t){this.updateVector()},e.prototype.updateVector=function(){var t=this,e=t.dummys[0];t.vector={x:e.x-t.pointRecord.x,y:e.y-t.pointRecord.y}},e.prototype.touchBegin=function(t){this.pointRecord={x:t.localX,y:t.localY},this.updateVector()},e.prototype.touchMove=function(t){var e=this;e.pointRecord={x:t.localX,y:t.localY},e.dispatch({x:t.localX+e.vector.x,y:t.localY+e.vector.y})},e}(Controler);__reflect(DragControler.prototype,"DragControler");var DragDummy=function(t){function e(e,i,r){var o=t.call(this,e)||this;return o.reflector=i,o.border=r,o}return __extends(e,t),e.prototype.setData=function(e,i,r){t.prototype.setControler.call(this,e),this.reflector=i,this.border=r},e.prototype.locate=function(t,e){var i=!1,r=this,o=r.border,n=o.top,a=o.right,s=o.bottom,h=o.left;h>t?(t=h,i=!0):t>a&&(t=a,i=!0),n>e?(e=n,i=!0):e>s&&(e=s,i=!0),c=[t,e],this.x=c[0],this.y=c[1];var c},e.prototype.update=function(t){var e=t.x,i=t.y;return this.locate(e,i),{x:this.x,y:this.y}},Object.defineProperty(e.prototype,"x",{get:function(){return this.reflector.x},set:function(t){this.reflector.x=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this.reflector.y},set:function(t){this.reflector.y=t},enumerable:!0,configurable:!0}),e}(Dummy);__reflect(DragDummy.prototype,"DragDummy");var Blue=function(t){function e(i,r){var o=t.call(this)||this;o.store=e.store,o.size={width:102,height:105},o.formation=HitWorldFormation.army,o.type=HitWorldType.damage,o.fireData={0:[15,5,25],1:[5,-5,15],2:[-5,-10,10]},o.status={hor:DirectHor.CENTER,ver:DirectVer.MIDDLE},o.ABLE_DISTANCE=100,o.fireDistance=200,o.gunDistance=34,o.initial(),o.layout();var n=o.size;return o.dragDummy=new DragDummy(r,o,{top:n.height/2,right:i.width-n.width/2,bottom:i.height-n.height/2,left:n.width/2}),DisUtil.location(o.display,i.width/2,i.height-2*o.size.height),o.changeDisplayHor(o.status.hor),o.changeDisplayVer(o.status.ver),o}return __extends(e,t),e.prototype.initial=function(){this.display=new egret.Sprite;window.innerHeight/window.innerWidth*750;this.leftDisplay=DisUtil.createBitmap("hero_left_png"),this.centerDisplay=DisUtil.createBitmap("hero_center_png"),this.rightDisplay=DisUtil.createBitmap("hero_right_png"),this.fire1=DisUtil.createBitmap("fire1_png"),this.fire2=DisUtil.createBitmap("fire2_png"),this.fire3=DisUtil.createBitmap("fire3_png")},e.prototype.layout=function(){DisUtil.anchorCenter(this.leftDisplay),DisUtil.anchorCenter(this.centerDisplay),DisUtil.anchorCenter(this.rightDisplay),DisUtil.anCenHor(this.fire1),DisUtil.anCenHor(this.fire2),DisUtil.anCenHor(this.fire3),DisUtil.addChildren(this.display,[this.fire1,this.fire2,this.fire3,this.leftDisplay,this.centerDisplay,this.rightDisplay])},e.prototype.changeDisplayHor=function(t){var e=[!1,!1,!1];e[t]=!0,this.leftDisplay.visible=e[0],this.centerDisplay.visible=e[1],this.rightDisplay.visible=e[2]},e.prototype.changeDisplayVer=function(t){var e=this,i=this.fireData[t];[this.fire1,this.fire2].forEach(function(e,r){var o=i[r];egret.Tween.removeTweens(e),egret.Tween.get(e).to({alpha:0},100).to({y:o}).call(function(){egret.Tween.get(e,{loop:!0}).to({alpha:1},100).to({y:o+10+10*r,alpha:0},100+100*t+50*r).to({y:o})})}),egret.Tween.removeTweens(this.fire3);var r=100*t+100;egret.Tween.get(this.fire3).to({alpha:1,y:i[2]},100).call(function(){egret.Tween.get(e.fire3,{loop:!0}).to({alpha:.7},r/2).to({alpha:1},r/2)})},e.prototype.dealDirectionHor=function(t){t!=this.status.hor&&(this.status.hor==t,this.changeDisplayHor(t),this.status.hor=t)},e.prototype.dealDirectionVer=function(t){t!=this.status.ver&&(this.status.ver=t,this.changeDisplayVer(t),this.status.ver=t)},e.prototype.analyseX=function(t){var i=this,r=t-i.x;Math.abs(r)<e.fixNum||(egret.clearTimeout(i.centerHorTimeout),this.dealDirectionHor(r>0?DirectHor.RIGHT:DirectHor.LEFT),i.centerHorTimeout=egret.setTimeout(function(){i.dealDirectionHor(DirectHor.CENTER)},i,200))},e.prototype.analyseY=function(t){var i=this,r=t-i.y;Math.abs(r)<e.fixNum||(egret.clearTimeout(i.middleVerTimeout),this.dealDirectionVer(0>r?DirectVer.TOP:DirectVer.BOTTOM),i.middleVerTimeout=egret.setTimeout(function(){i.dealDirectionVer(DirectVer.MIDDLE)},i,200))},Object.defineProperty(e.prototype,"x",{get:function(){return this.display.x},set:function(t){this.analyseX(t),this.display.x=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this.display.y},set:function(t){this.analyseY(t),this.display.y=t},enumerable:!0,configurable:!0}),e.prototype.beginFire=function(){var t=this;this.fire(),this.fireTimeout=egret.setTimeout(function(){t.beginFire()},this,this.fireDistance)},e.prototype.stopFire=function(){egret.clearTimeout(this.fireTimeout)},e.prototype.fire=function(){var t=this.getWorldDot().location,e=Light1.store.getInstance(this.formation);this.world.addObj(e),r=[t.x+this.gunDistance,this.y],e.x=r[0],e.y=r[1],e.go();var i=Light1.store.getInstance(this.formation);this.world.addObj(i),o=[t.x-this.gunDistance,this.y],i.x=o[0],i.y=o[1],i.go();var r,o},e.fixNum=10,e}(WorldObject);__reflect(Blue.prototype,"Blue");var O1=function(t){function e(){var i=t.call(this)||this;return i.store=e.store,i.formation=HitWorldFormation.enemy,i.type=HitWorldType.damage,i.size={width:80,height:80},i.life=1e4,i.attackDistance=1e3,i.roundDistance=400,i.initial(),i.layout(),i}return __extends(e,t),e.prototype.initial=function(){this.hitShapes.push(new HitShape(this,new HitCircle({arr:[0,0],radius:this.size.width/2}))),this.display=this.wraper=new egret.DisplayObjectContainer,this.base=DisUtil.createBitmap("o1_base_png"),this.eyeL=DisUtil.createBitmap("eye_o1_png"),this.eyeR=DisUtil.createBitmap("eye_o1_png")},e.prototype.layout=function(){DisUtil.anchorCenter(this.base),this.wraper.addChild(this.base),DisUtil.anchorCenter(this.eyeL),DisUtil.location(this.eyeL,-20,20),this.wraper.addChild(this.eyeL),DisUtil.anchorCenter(this.eyeR),DisUtil.location(this.eyeR,20,20),this.wraper.addChild(this.eyeR)},e.prototype.wakeUp=function(){this.isAlive=!0,this.startAlive()},e.prototype.sleep=function(){egret.clearTimeout(this.aliveTimeout),egret.clearTimeout(this.attackTimeout)},e.prototype.startAlive=function(){var t=this;this.onAlive(),this.aliveTimeout=egret.setTimeout(function(){t.startAlive()},this,this.aliveDistance)},e.prototype.onAlive=function(){Shadow.getInstance("o12_png").playNormal({x:this.x,y:this.y},this.world,500,Index.BOTTOM,AnimationUnit.mini)},e.prototype.startAttack=function(){var t=this;this.onAttack(),this.attackTimeout=egret.setTimeout(function(){t.startAttack()},this,this.attackDistance)},e.prototype.onAttack=function(){var t=this.world.manager[HitWorldFormation.army][HitWorldType.damage][0];if(t){var e=(4*Math.random()+1)*Math.PI/6,i=Math.PI/2-e,r=t.x+Math.cos(e)*this.roundDistance,o=t.y-Math.sin(e)*this.roundDistance;egret.Tween.removeTweens(this),egret.Tween.get(this).to({x:r,y:o},this.attackDistance,egret.Ease.quadInOut),egret.Tween.get(this).to({rotation:180*i/Math.PI},this.attackDistance,egret.Ease.quadInOut)}},e.prototype.beingHit=function(){t.prototype.beingHit.call(this),egret.Tween.removeTweens(this.base),egret.Tween.get(this.base).to({scaleX:1.5,scaleY:1.5},100).to({scaleX:1,scaleY:1},100)},e}(WorldObject);__reflect(O1.prototype,"O1");var O1Dot=function(t){function e(){var i=t.call(this)||this;return i.store=e.store,i.formation=HitWorldFormation.enemy,i.size={width:40,height:40},i.attackDistance=2e3,i.life=1e4,i.initial(),i}return __extends(e,t),e.prototype.initial=function(){this.hitShapes.push(new HitShape(this,new HitCircle({arr:[0,0],radius:this.size.width/2})));var t=DisUtil.createBitmap("o1_base2_png");DisUtil.anchorCenter(t),this.display=t,this.behavior=new FlyCircle(this)},e.prototype.onAlive=function(){var t=this.getWorldDot();Shadow.getInstance("o1_png").playNormal(t.location,this.world,500,Index.BOTTOM,AnimationUnit.mini)},e.prototype.onAttack=function(){var t=this.getWorldDot(),e=BulletO1.store.getInstance(this.formation);e.x=t.location.x,e.y=t.location.y,this.world.addObj(e),e.go()},e}(WorldObject);__reflect(O1Dot.prototype,"O1Dot");var UnionO=function(t){function e(){var i=t.call(this)||this;return i.store=e.store,i.formation=HitWorldFormation.enemy,i.type=HitWorldType.damage,i.initial(),i.behavior=new FlyAroundArmy(i,{timeDistance:2e3,radius:400,angle:2*Math.PI/3}),i}return __extends(e,t),e.prototype.initial=function(){var t=new O1;this.addChild(t);for(var e=4e3,i=120,r=4;r--;){var o=O1Dot.store.getInstance(),n=Math.PI/2*r;o.x=Math.cos(n)*i,o.y=Math.sin(n)*i,o.behavior.setData({beginAngle:n,totalTime:e,radius:i}),this.addChild(o)}},e}(HitObjectContainer);__reflect(UnionO.prototype,"UnionO");var PlayLimitless=function(t){function e(){var e=t.call(this)||this;return e.world=new HitWorld(DisUtil.STAND_WIDTH,DisUtil.FWH),e.initial(),e.layout(),e}return __extends(e,t),e.prototype.initial=function(){DisUtil.size(this.world,DisUtil.STAND_WIDTH,DisUtil.FWH),this.dragControler=new DragControler(this.world.width,this.world.height),this.dummy=new Blue(this.world,this.dragControler)},e.prototype.layout=function(){this.addChild(this.world),this.world.addChild(this.dragControler.getToucher()),this.world.addObj(this.dummy),this.dummy.beginFire(),LayUtil.get(this.world).fitW().bottom()},e.prototype.start=function(){this.world.start();var t=new UnionO;e=[this.world.width/2,this.world.height/2],t.x=e[0],t.y=e[1],this.world.addObj(t),t.go();var e},e.prototype.stop=function(){},e}(egret.DisplayObjectContainer);__reflect(PlayLimitless.prototype,"PlayLimitless");var ArrUtil=function(){function t(){}return t.scale=function(e,i){for(var r,o=e.length,n=0;o>n;n++)r=e[n],r instanceof Array?t.scale(r,i):e[n]*=i},t}();__reflect(ArrUtil.prototype,"ArrUtil");var DisUtil=function(){function t(){}return t.initial=function(){var e=document.getElementsByClassName("egret-player")[0];
t.STAND_WIDTH=+e.getAttribute("data-content-width"),t.STAND_HEIGHT=+e.getAttribute("data-content-height");var i=window.innerWidth,r=window.innerHeight,o=r/i,n=t.STAND_HEIGHT/t.STAND_WIDTH;t.FW=i/t.STAND_WIDTH,t.FH=r/t.STAND_HEIGHT,n>o?(a=[t.FH,t.FW],t.SA=a[0],t.CA=a[1]):(s=[t.FW,t.FH],t.SA=s[0],t.CA=s[1]),t.FHW=t.STAND_HEIGHT/o,t.FWH=t.STAND_WIDTH*o;var a,s},t.setStandSize=function(e){t.size(e,t.STAND_WIDTH,t.STAND_HEIGHT)},t.createBitmap=function(t){var e=RES.getRes(t),i=new egret.Bitmap;return i.texture=e,i},t.getRect=function(e,i,r){var o=new egret.Shape;t.size(o,e,i);var n=o.graphics;return n.beginFill(r),n.drawRect(0,0,e,i),n.endFill(),o},t.size=function(t,e,i){t.width=e,t.height=i},t.location=function(t,e,i){t.x=e,t.y=i},t.anchorCenter=function(t){t.anchorOffsetX=t.width/2,t.anchorOffsetY=t.height/2},t.anCenHor=function(t){t.anchorOffsetX=t.width/2},t.anCenVer=function(t){t.anchorOffsetY=t.height/2},t.addChildren=function(t,e){e.forEach(function(e){t.addChild(e)})},t.scale=function(t,e){t.scaleX=t.scaleY=e},t.setProps=function(t,e){for(var i in e)t.forEach(function(t){t[i]=e[i]})},t.show=function(t){egret.log("x: "+t.x+"\n			y: "+t.y+"\n			width: "+t.width+"\n			height: "+t.height+"\n			scaleX: "+t.scaleX+"\n			scaleY: "+t.scaleY+"\n			rotation: "+t.rotation)},t}();__reflect(DisUtil.prototype,"DisUtil");var DraUtil=function(){function t(){}return t.getCloLine=function(t,e){var i=new egret.Shape,r=i.graphics,o=e||[1,0];(c=r.lineStyle).call.apply(c,[r].concat(o));var n,a=1,s=t.length,h=t[0];for(r.moveTo(h.x,h.y);s>a;)n=t[a],r.lineTo(n.x,n.y),a++;return r.lineTo(h.x,h.y),i;var c},t.getPoArr=function(t){for(var e,i=t.length,r=0,o=[];i>r;)e=t[r],o.push(new Vector(e[0],e[1])),r++;return o},t.getGrd=function(e,i,r,o,n,a){var s=new egret.Shape;s.width=e,s.height=i,n=n||20,a=a||20,r=r||0,o=o||16777215;var h=s.graphics;h.beginFill(r);var c=Math.floor(i/a),l=Math.floor(e/n),u=e-l*n,p=i-c*a;t.draColGrid(r,h,0,l,c,n,a,u,p,c%2),t.draColGrid(o,h,1,l,c,n,a,u,p,(c+1)%2);var f=Math.abs(l-c)%2==0?r:o;return h.drawRect(l*n,c*a,0,0),h.beginFill(f),h.drawRect(l*n,c*a,u,p),s},t.draColGrid=function(e,i,r,o,n,a,s,h,c,l){var u=0;i.beginFill(e);for(var p=0;o>p;p++,u+=a,r=r?0:1)t.drawGridLineVer(i,a,s,r,n,u);0!=h&&t.drawGridLineVer(i,h,s,r,n,u),0!=c&&t.drawGridLineHor(i,a,c,l,o,n*s)},t.drawGridLineVer=function(t,e,i,r,o,n){for(var a=r*i,s=2*i,h=r;o>h;h+=2)t.drawRect(n,a,e,i),a+=s},t.drawGridLineHor=function(t,e,i,r,o,n){for(var a=r*e,s=2*e,h=r;o>h;h+=2)t.drawRect(a,n,e,i),a+=s},t.fillGrid=function(e,i,r,o,n,a){var s=t.getGrd(e.width,e.height,r,o,n,a);i=0==i?0:i?i:1,s.alpha=i,e.addChild(s)},t.drawTansBg=function(t){var e=new egret.Shape;r=[t.width,t.height],e.width=r[0],e.height=r[1];var i=e.graphics;i.beginFill(16777215,0),i.drawRect(0,0,e.width,e.height),i.endFill(),t.addChildAt(e,0);var r},t}();__reflect(DraUtil.prototype,"DraUtil");var LayUtil=function(){function t(){}return t.size=function(t,e,i){t.width=e,t.height=i},t.ancho=function(t,e,i){t.anchorOffsetX=e,t.anchorOffsetY=i},t.getDisCon=function(t){var e=new egret.DisplayObjectContainer;return NorUtil.set(e,t),e},t.getGridCon=function(t,e,i){var r=new egret.DisplayObjectContainer;return NorUtil.set(r,t),DraUtil.fillGrid(r,e,i),r},t.location=function(t,e,i){t.x=e,t.y=i},t.getCloneBase=function(e){var i=new egret.DisplayObject;return t.location(i,0,0),t.size(i,e.width,e.height),i},t.getRelaRect=function(e,i){var r=t.getCloneBase(e);return r=t.getInRectRelaRect(r,e,i)},t.getInRectRelaRect=function(t,e,i){for(var r,o,n,a;e!=i;)egret.is(e,"egret.Stage")?(r=0,o=0,n=1,a=1):(r=e.x,o=e.y,n=e.scaleX,a=e.scaleY),t.x=r+(t.x-e.anchorOffsetX)*n,t.y=o+(t.y-e.anchorOffsetY)*a,t.width*=n,t.height*=a,e=e.parent;return t},t.get=function(e,i){var r=t.getRelaRect(e,i);return new situate(r,e,i)},t.setScal=function(t,e){t.scaleX=t.scaleY=e},t.scale=function(t,e){t.scaleX*=e,t.scaleY*=e},t.scalLen=function(t,e){t.width*=e,t.height*=e},t.disShow=function(t,e){e=e?e:1,console.log("x:"+t.x.toFixed(e)+",y:"+t.y.toFixed(e)+",anchorOffsetX:"+t.anchorOffsetX.toFixed(e)+",anchorOffsetY:"+t.anchorOffsetY.toFixed(e)+",scaleX:"+t.scaleX.toFixed(e)+",scaleY:"+t.scaleY.toFixed(e)+",width:"+t.width.toFixed(e)+",height:"+t.height.toFixed(e)+",alpha:"+t.alpha)},t}();__reflect(LayUtil.prototype,"LayUtil");var situate=function(){function t(t,e,i){this.relRect=t,this.disObj=e,this.ancient=i,i?(this.conWidth=i.width,this.conHeight=i.height):(this.conWidth=window.innerWidth,this.conHeight=window.innerHeight),this.anRateX=e.anchorOffsetX/e.width,this.anRateY=e.anchorOffsetY/e.height}return t.prototype.scale=function(t){var e=this,i=this.anRateX*(t-1)*e.relRect.width,r=this.anRateY*(t-1)*e.relRect.height;LayUtil.scale(e.disObj,t),LayUtil.scalLen(e.relRect,t),e.relRect.x-=i,e.relRect.y-=r},t.prototype.moveX=function(t,e){var i=this;i.relRect.x+=t,i.disObj.x+=t*=e},t.prototype.moveY=function(t,e){var i=this;i.relRect.y+=t,i.disObj.y+=t*=e},t.prototype.fitW=function(){var t=this;if(0==t.relRect.width)return egret.error("宽度为0的显示对象无法应用“适应宽度”的缩放模式"),this;var e=t.conWidth/t.relRect.width;return t.scale(e),t.cenHor(),t},t.prototype.fitH=function(){var t=this;if(0==t.relRect.height)return egret.error("高度为0的显示对象无法应用“适应高度”的缩放模式"),this;var e=t.conHeight/t.relRect.height;return t.scale(e),t.cenVer(),t},t.prototype.beCon=function(){var t=this,e=t.conWidth/t.conHeight,i=t.relRect.width/t.relRect.height,r=i>=e?t.conWidth/t.relRect.width:t.conHeight/t.relRect.height;return t.scale(r),t.center(),this},t.prototype.cover=function(){var t=this,e=t.conWidth/t.conHeight,i=t.relRect.width/t.relRect.height,r=i>=e?t.conHeight/t.relRect.height:t.conWidth/t.relRect.width;return t.scale(r),t.center(),this},t.prototype.center=function(){return this.cenVer(),this.cenHor(),this},t.prototype.cenVer=function(){var t=this,e=t.conHeight/2-t.relRect.y-t.relRect.height/2,i=t.disObj.height*t.disObj.scaleY/t.relRect.height;return t.moveY(e,i),t},t.prototype.cenHor=function(){var t=this,e=t.conWidth/2-t.relRect.x-t.relRect.width/2,i=t.disObj.width*t.disObj.scaleX/t.relRect.width;return t.moveX(e,i),t},t.prototype.left=function(t){t=null==t?0:t;var e=this,i=e.disObj.width*e.disObj.scaleX/e.relRect.width,r=t-e.relRect.x;return e.moveX(r,i),this},t.prototype.right=function(t){var e=this;t=null==t?0:t;var i=e.disObj.width*e.disObj.scaleX/e.relRect.width,r=e.conWidth-e.relRect.x-e.relRect.width-t;return e.moveX(r,i),this},t.prototype.top=function(t){t=null==t?0:t;var e=this,i=e.disObj.height*e.disObj.scaleY/e.relRect.height,r=t-e.relRect.y;return e.moveY(r,i),this},t.prototype.bottom=function(t){t=null==t?0:t;var e=this;t=null==t?0:t;var i=e.disObj.height*e.disObj.scaleY/e.relRect.height,r=e.conHeight-e.relRect.y-e.relRect.height-t;return e.moveY(r,i),this},t.prototype.show=function(t){t=t?t:1;var e=this.relRect;return console.log("x:"+e.x.toFixed(t)+",y:"+e.y.toFixed(t)+",width:"+e.width.toFixed(t)+",height:"+e.height.toFixed(t)),this},t}();__reflect(situate.prototype,"situate");var Line=function(){function t(t,e){this.k=t,this.b=e}return t.prototype.getY=function(t){return isNaN(this.k)&&egret.warn("斜率不为数字"),this.k*t+this.b},t.prototype.getX=function(t){return 0==this.k&&egret.warn("斜率为0"),isNaN(this.k)?this.b:(t-this.b)/this.k},t.getLine=function(e,i){var r=Matrix.undo([[e.x,1,-e.y],[i.x,1,-i.y]]);if(null==r)var o=[0/0,e.x],n=o[0],a=o[1];else var n=r[0],a=r[1];return new t(n,a)},t}();__reflect(Line.prototype,"Line");var Matrix=function(){function t(){}return t.scale=function(t,e){return t.map(function(t){return t*e})},t.sub=function(t,e){for(var i=[],r=0,o=t.length;o>r;r++)i[r]=t[r]-e[r];return i},t.add=function(t,e){for(var i=[],r=0,o=t.length;o>r;r++)i[r]=t[r]+e[r];return i},t.undo=function(e){for(var i=[],r=0;0==e[0][0];){if(r++,r==e.length)return null;e.push(e.splice(0,1)[0])}e[0]=t.scale(e[0],1/e[0][0]);for(var o=1,n=e.length;n>o;o++){for(var a=0;o>a;a++)0!=e[o][a]&&(e[o]=t.scale(e[o],1/e[o][a]),e[o]=t.sub(e[o],e[a]));if(0==e[o][a]){for(var s=0,h=n-o+1;0==e[o][a];){if(s++,s==h)return null;e.push(e.splice(o,1)[0])}o--}else e[o]=t.scale(e[o],1/e[o][a])}for(var o=e.length-1;o>=0;o--)for(var c=0;o>c;c++)e[c]=t.sub(e[c],t.scale(e[o],e[c][o]));for(var o=0,n=e.length;n>o;o++)i[o]=-e[o][n];return i},t}();__reflect(Matrix.prototype,"Matrix");var HitType;!function(t){t[t.DOT=0]="DOT",t[t.CIRCLE=1]="CIRCLE",t[t.CONVEX=2]="CONVEX"}(HitType||(HitType={}));var HitUtil=function(){function t(){}return t.hitDotDot=function(t,e){return t.x==e.x&&t.y==e.y},t.hitDotCircle=function(t,e){var i=Math.sqrt(Math.pow(t.x-e.dot.x,2)+Math.pow(t.y-e.dot.y,2));return i<e.radius},t.hitDotCon=function(e,i){var r=new Vector(1,0);i=i.map(function(t){return new Vector(t.x-e.x,t.y-e.y)});var o=new Array,n=t.getFar(i,r);for(o.push(n),r.negate();;){if(n=t.getFar(i,r),o.push(n),r.dot(o[o.length-1])<=0)return!1;if(t.conOr(o,r))return!0}},t.hitCirCir=function(t,e){var i=Math.sqrt(Math.pow(t.dot.x-e.dot.x,2)+Math.pow(t.dot.y-e.dot.y,2));return i<t.radius+e.radius},t.hitCirCon=function(e,i){for(var r,o=0,n=i;o<n.length;o++){var a=n[o];if(r=t.hitDotCircle(a,e))return!0}return!1},t.hitConCon=function(e,i){var r=new Vector(1,0),o=new Array;for(o.push(t.support(e,i,r)),r.negate();;){if(o.push(t.support(e,i,r)),r.dot(o[o.length-1])<=0)return!1;if(t.conOr(o,r))return!0}},t.support=function(e,i,r){var o=t.getFar(e,r);r.negate();var n=t.getFar(i,r);return r.negate(),new Vector(o.x-n.x,o.y-n.y)},t.conOr=function(t,e){var i,r,o,n,a,s,h=t.length,c=t[h-1],l=c.getNeg();if(3==h)if(i=t[h-2],r=t[h-3],o=Vector.getVec(c,i),n=Vector.getVec(c,r),a=Vector.tripleProduct(n,o,o),s=Vector.tripleProduct(o,n,n),a.dot(l)>0)t.shift(),e.copy(a);else{if(!(s.dot(l)>0))return!0;t.splice(1,1),e.copy(s)}else{if(i=t[h-2],o=Vector.getVec(c,i),a=Vector.tripleProduct(o,l,o),0===a.x&&0===a.y)return!0;e.copy(a)}return!1},t.getFar=function(t,e){var i,r,o=0,n=t.length,a=0,s=e.dot(t[o]);for(o++;n>o;){if(i=e.dot(t[o]),i>s)s=i,a=o,r=!0;else if(r)break;o++}return t[a]},t}();__reflect(HitUtil.prototype,"HitUtil");var Vector=function(t){function e(e,i){return t.call(this,e,i)||this}return __extends(e,t),e.getVectors=function(t){var i=new Array;return t.forEach(function(t){i.push(new e(t[0],t[1]))}),i},e.prototype.copy=function(t){e=[t.x,t.y],this.x=e[0],this.y=e[1];var e},e.prototype.negate=function(){t=[-this.x,-this.y],this.x=t[0],this.y=t[1];var t},e.prototype.getNeg=function(){return new e(-this.x,-this.y)},e.prototype.dot=function(t){return this.x*t.x+this.y*t.y},e.prototype.scale=function(t){this.x*=t,this.y*=t},e.prototype.getScale=function(t){return new e(this.x*t,this.y*t)},e.prototype.getRotate=function(t){if(0==t)return this;var i=Math.cos(t),r=Math.sin(t),o=this;return t>0?new e(i*o.x+r*o.y,-r*o.x+i*o.y):new e(i*o.x-r*o.y,r*o.x+i*o.y)},e.getVec=function(t,i){return new e(i.x-t.x,i.y-t.y)},e.tripleProduct=function(t,i,r){return e.getVec(t.getScale(i.dot(r)),i.getScale(t.dot(r)))},e}(egret.Point);__reflect(Vector.prototype,"Vector");var HitCircle=function(t){function e(e){var i=t.call(this,HitType.CIRCLE,e)||this;return i.set(e),i}return __extends(e,t),e.prototype.set=function(t){this.data={dot:new egret.Point(t.arr[0],t.arr[1]),radius:t.radius},this.moment={dot:new Vector(t.arr[0],t.arr[1]),radius:t.radius}},e.prototype.update=function(t,e){var i=t.x,r=t.y,o=NorUtil.getRotate(this.data.dot,e);this.moment.dot.setTo(i+o.x,r+o.y)},e.prototype.updateByCoe=function(t,e){var i=t.x,r=t.y,o=e.getCoeResult(this.data.dot);this.moment.dot.setTo(i+o.x,r+o.y)},e}(HitModel);__reflect(HitCircle.prototype,"HitCircle");var HitConvex=function(t){function e(e){return t.call(this,HitType.CONVEX,e)||this}return __extends(e,t),e.prototype.set=function(t){var e=this;this.data=new Array,this.moment=new Array,t.forEach(function(t){e.data.push(new egret.Point(t[0],t[1])),e.moment.push(new Vector(t[0],t[1]))})},e.prototype.update=function(t,e){var i=this,r=t.x,o=t.y;this.moment.forEach(function(t,n){var a=i.data[n],s=NorUtil.getRotate({x:a.x,y:a.y},e);t.setTo(r+s.x,o+s.y)})},e.prototype.updateByCoe=function(t,e){var i=this,r=t.x,o=t.y;this.moment.forEach(function(t,n){var a=i.data[n],s=e.getCoeResult({x:a.x,y:a.y});t.setTo(r+s.x,o+s.y)})},e}(HitModel);__reflect(HitConvex.prototype,"HitConvex");var HitDot=function(t){function e(e){return t.call(this,HitType.DOT,e)||this}return __extends(e,t),e.prototype.set=function(t){this.data=new egret.Point(t[0],t[1]),this.moment=new Vector(t[0],t[1])},e.prototype.update=function(t,e){var i=t.x,r=t.y,o=NorUtil.getRotate({x:this.data.x,y:this.data.y},e);this.moment.setTo(i+o.x,r+o.y)},e.prototype.updateByCoe=function(t,e){var i=t.x,r=t.y,o=e.getCoeResult({x:this.data.x,y:this.data.y});this.moment.setTo(i+o.x,r+o.y)},e}(HitModel);__reflect(HitDot.prototype,"HitDot");var LoadingUI=function(t){function e(){var e=t.call(this)||this;return e.createView(),e}return __extends(e,t),e.prototype.createView=function(){DisUtil.setStandSize(this),LayUtil.get(this).beCon(),this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.size=40,this.textField.textAlign="center",LayUtil.get(this.textField,this).center()},e.prototype.onProgress=function(t,e){this.textField.text="Loading..."+Math.ceil(t/e*100)+"%"},e}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI",["RES.PromiseTaskReporter"]);var NorUtil=function(){function t(){}return t.set=function(t,e){for(var i in e)t[i]=e[i]},t.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=t.map(function(t){return JSON.stringify(t)});console.log.apply(console,[""].concat(i))},t.getRotate=function(e,i){var r=e.x,o=e.y;if(0==i)return{x:r,y:o};i=t.numToPI(i);var n=Math.cos(i),a=Math.sin(i);return i>0?{x:n*r+a*o,y:-a*r+n*o}:{x:n*r-a*o,y:a*r+n*o}},t.getRotateCoe=function(e){e=t.numToPI(e);var i=Math.cos(e),r=Math.sin(e);e=t.numToPI(e);var o={xCoe:{xMul:i,yMul:r},yCoe:{xMul:r,yMul:i}};return e>0?o.yCoe.xMul=-r:o.xCoe.yMul=-r,new RotationCoe(new RotationUnitCoe(o.xCoe.xMul,o.xCoe.yMul),new RotationUnitCoe(o.yCoe.xMul,o.yCoe.yMul))},t.getStore=function(t){function e(){return o.length}function i(t){t.clear(),o.push(t)}function r(e){var i=o.pop();return i?(i.set(e),i):new t(e)}var o=new Array;return{recovery:i,getInstance:r,getCount:e}},t.numToPI=function(t){return t/180*Math.PI},t.pIToNum=function(t){return 180*t/Math.PI},t}();__reflect(NorUtil.prototype,"NorUtil");var RotationUnitCoe=function(){function t(t,e){this.xMul=t,this.yMul=e}return t.prototype.getCoeResult=function(t){var e=t.x,i=t.y;return e*this.xMul+i*this.yMul},t}();__reflect(RotationUnitCoe.prototype,"RotationUnitCoe");var RotationCoe=function(){function t(t,e){this.xCoe=t,this.yCoe=e}return t.prototype.getCoeResult=function(t){var e=t.x,i=t.y;return{x:this.xCoe.getCoeResult({x:e,y:i}),y:this.yCoe.getCoeResult({x:e,y:i})}},t}();__reflect(RotationCoe.prototype,"RotationCoe");