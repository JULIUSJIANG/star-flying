function Initial(){DisUtil.initial(),HitModel.initial(),ColorFilter.initial();var t=[HitObject,HitObjectContainer,Light1,BulletO1,O1,UnionO,Blue,O1Dot];t.forEach(function(t){t.store=NorUtil.getStore(t)})}var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i},__awaiter=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))(function(o,r){function a(t){try{c(n.next(t))}catch(e){r(e)}}function s(t){try{c(n["throw"](t))}catch(e){r(e)}}function c(t){t.done?o(t.value):new i(function(e){e(t.value)}).then(a,s)}c((n=n.apply(t,e||[])).next())})},__generator=this&&this.__generator||function(t,e){function i(t){return function(e){return n([t,e])}}function n(i){if(o)throw new TypeError("Generator is already executing.");for(;c;)try{if(o=1,r&&(a=r[2&i[0]?"return":i[0]?"throw":"next"])&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[0,a.value]),i[0]){case 0:case 1:a=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,r=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(a=c.trys,!(a=a.length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){c=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){c.label=i[1];break}if(6===i[0]&&c.label<a[1]){c.label=a[1],a=i;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(i);break}a[2]&&c.ops.pop(),c.trys.pop();continue}i=e.call(t,c)}catch(n){i=[6,n],r=0}finally{o=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var o,r,a,s,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:i(0),"throw":i(1),"return":i(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},__assign=this&&this.__assign||Object.assign||function(t){for(var e,i=1,n=arguments.length;n>i;i++){e=arguments[i];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},HitObject=function(){function t(e){this.store=t.store,this.size={width:0,height:0},this.damage=1,this.life=0,this.hitShapes=new Array,this.behavior=Behavior.getInstance(),this.initial(),this.set(e)}return t.prototype.getDefaultLife=function(){return 0},t.prototype.set=function(t){var e=t.BehaviorFun,i=t.formation;this.isAlive=!0,this.formation=i,this.life=this.getDefaultLife(),e&&(this.behavior=new e(this))},t.prototype.clear=function(){this.miss()},t.prototype.initial=function(){},t.prototype.getWorldDot=function(){for(var t=this.getDisplay(),e=this.world,i={location:{x:t.x,y:t.y},rotation:t.rotation};t.parent!=e;)t=t.parent,i.location=NorUtil.getRotateRe(i.location,t.rotation),i.location.x+=t.x,i.location.y+=t.y,i.rotation+=t.rotation;return i},t.prototype.getFor=function(){return this.formation},t.prototype.getType=function(){return this.type},t.prototype.getDisplay=function(){return this.display},Object.defineProperty(t.prototype,"world",{get:function(){return this._world},set:function(t){this._world=t},enumerable:!0,configurable:!0}),t.prototype.getHitShapes=function(t,e){void 0===t&&(t={x:0,y:0}),void 0===e&&(e=0);var i=t.x,n=t.y,o=NorUtil.getRotateRe({x:this.x,y:this.y},e),r=NorUtil.getRotateCoeRe(e);return this.updateHitShapesByCoe({x:i+o.x,y:n+o.y},r),this.hitShapes},t.prototype.updateHitShapes=function(t,e){var i=t.x,n=t.y;this.hitShapes.forEach(function(t){t.update({x:i,y:n},e)})},t.prototype.updateHitShapesByCoe=function(t,e){var i=t.x,n=t.y;this.hitShapes.forEach(function(t){t.updateByCoe({x:i,y:n},e)})},t.prototype.go=function(t){this.wakeUp(),this.behavior.start()},t.prototype.setBehavior=function(t,e){this.behavior=new t(this,e)},t.prototype.wakeUp=function(){this.aliveDistance&&this.alive(),this.attackDistance&&this.attack()},t.prototype.alive=function(){var t=this;this.onAlive(),this.aliveTimeout=egret.setTimeout(function(){t.alive()},this,this.aliveDistance)},t.prototype.onAlive=function(){},t.prototype.attack=function(){var t=this;egret.Tween.get(this,{loop:!0}).call(function(){t.onAttack()}).wait(this.attackDistance)},t.prototype.onAttack=function(){},t.prototype.hitOther=function(t){this.beingHit(),t.deCline(this.damage)},t.prototype.beingHit=function(){ColorFilter.redFlash(this.display,200)},t.prototype.deCline=function(t){this.life-=t,this.life<=0&&this.destroy()},t.prototype.destroy=function(){var t=this.parent,e=this.world;this.desAn(),this.miss(),t&&t.getInfo(this),e.getInfo(this)},t.prototype.desAn=function(){this.type==HitWorldType.bullet?BitAnimation.getInstance("explode_nor_png").explodeIn(this.getWorldDot().location,this.size,this.world):this.type==HitWorldType.damage&&BitAnimation.getInstance("explode_nor_png").explodeAround(this.getWorldDot().location,this.size,this.world)},t.prototype.getAlive=function(){return this.isAlive},t.prototype.miss=function(){if(this.isAlive){if(this.isAlive=!1,this.sleep(),this.parent){this.parent;this.parent.removeChild(this)}else this.world.removeObj(this);this.store.recovery(this)}},t.prototype.sleep=function(){this.behavior.stop(),egret.Tween.removeTweens(this),egret.clearTimeout(this.aliveTimeout)},Object.defineProperty(t.prototype,"x",{get:function(){return this.display.x},set:function(t){this.display.x=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this.display.y},set:function(t){this.display.y=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rotation",{get:function(){return this.display.rotation},set:function(t){this.display.rotation=t},enumerable:!0,configurable:!0}),t.prototype.pause=function(){this.behavior.pause(),egret.Tween.pauseTweens(this),egret.clearTimeout(this.aliveTimeout)},t.prototype["continue"]=function(){this.behavior["continue"](),egret.Tween.resumeTweens(this),this.aliveDistance&&this.alive()},t}();__reflect(HitObject.prototype,"HitObject",["Product"]);var Behavior=function(){function t(t,e){this.hitObj=t,this.setData(e)}return t.getInstance=function(){return t.instance},t.prototype.setData=function(t){this.data=t},t.prototype.start=function(){},t.prototype.stop=function(){},t.prototype.pause=function(){},t.prototype["continue"]=function(){},t.instance=new t(null),t}();__reflect(Behavior.prototype,"Behavior");var Controler=function(){function t(){this.dummys=[]}return t.prototype.connectR=function(t){this.dummys.push(t)},t.prototype.connect=function(t){t.setControler(this)},t.prototype.disConnect=function(t){this.dummys.splice(this.dummys.indexOf(t),1)},t.prototype.dispatch=function(t){this.dummys.forEach(function(e){e.getDispatch(t)})},t.prototype.getRespond=function(t){},t}();__reflect(Controler.prototype,"Controler");var Dummy=function(){function t(){}return t.prototype.outOfControl=function(){this.controler&&this.controler.disConnect(this)},t.prototype.setControler=function(t){this.controler&&this.controler.disConnect(this),t.connectR(this),this.controler=t},t.prototype.getDispatch=function(t){this.respond(this.update(t))},t.prototype.respond=function(t){this.controler.getRespond(t)},t}();__reflect(Dummy.prototype,"Dummy");var HitObjectContainer=function(t){function e(i){var n=t.call(this,i)||this;return n.store=e.store,n.children=new Array,n.initialEle(),n}return __extends(e,t),e.prototype.initialEle=function(){this.display=new egret.Sprite},e.prototype.addChild=function(t){t.world=this.world,t.parent=this,this.display.addChild(t.getDisplay()),this.children.push(t)},e.prototype.removeChild=function(t){this.display.removeChild(t.getDisplay()),this.children.splice(this.children.indexOf(t),1),t.parent=null},Object.defineProperty(e.prototype,"world",{get:function(){return this._world},set:function(t){this._world=t,this.children.forEach(function(e){e.world=t})},enumerable:!0,configurable:!0}),e.prototype.getInfo=function(t){},e.prototype.getHitShapes=function(t,e){void 0===t&&(t={x:0,y:0}),void 0===e&&(e=0);var i=t.x,n=t.y,o=NorUtil.getRotateRe({x:this.x,y:this.y},e);return this.updateHitShapes({x:i+o.x,y:n+o.y},this.rotation+e),this.hitShapes},e.prototype.updateHitShapes=function(t,e){var i=t.x,n=t.y;this.hitShapes=[].concat.apply([],this.children.map(function(t){return t.getHitShapes({x:i,y:n},e)}))},e.prototype.go=function(){t.prototype.go.call(this),this.children.forEach(function(t){t.go()})},e.prototype.destroy=function(){for(var e=this.children.slice(),i=0,n=e;i<n.length;i++){var o=n[i];o.destroy()}t.prototype.destroy.call(this)},e.prototype.miss=function(){for(var e=this.children.slice(),i=0,n=e;i<n.length;i++){var o=n[i];o.miss()}t.prototype.miss.call(this)},e.prototype.pause=function(){t.prototype.pause.call(this);for(var e=0,i=this.children;e<i.length;e++){var n=i[e];n.pause()}},e.prototype["continue"]=function(){t.prototype["continue"].call(this);for(var e=0,i=this.children;e<i.length;e++){var n=i[e];n["continue"]()}},e}(HitObject);__reflect(HitObjectContainer.prototype,"HitObjectContainer");var HitWorld=function(t){function e(e,i){var n=t.call(this)||this;return n.manager=[],n.hitDistance=16,DisUtil.size(n,e,i),n.manager[HitWorldFormation.army]=[],n.manager[HitWorldFormation.army][HitWorldType.damage]=[],n.manager[HitWorldFormation.army][HitWorldType.bullet]=[],n.manager[HitWorldFormation.enemy]=[],n.manager[HitWorldFormation.enemy][HitWorldType.damage]=[],n.manager[HitWorldFormation.enemy][HitWorldType.bullet]=[],n}return __extends(e,t),e.prototype.startHitTest=function(){this.hitAD_EB(),this.hitED_AB(),this.hitAD_ED()},e.prototype.stopHitTest=function(){egret.clearTimeout(this.hitAD_EBTimeout),egret.clearTimeout(this.hitAD_EDTimeout),egret.clearTimeout(this.hitED_ABTimeout)},e.prototype.pause=function(){egret.clearTimeout(this.hitAD_EBTimeout),egret.clearTimeout(this.hitAD_EDTimeout),egret.clearTimeout(this.hitED_ABTimeout);for(var t=0,e=this.manager;t<e.length;t++)for(var i=e[t],n=0,o=i;n<o.length;n++)for(var r=o[n],a=0,s=r;a<s.length;a++){var c=s[a];c.pause()}},e.prototype["continue"]=function(){this.hitAD_EB(),this.hitED_AB(),this.hitAD_ED();for(var t=0,e=this.manager;t<e.length;t++)for(var i=e[t],n=0,o=i;n<o.length;n++)for(var r=o[n],a=0,s=r;a<s.length;a++){var c=s[a];c["continue"]()}},e.prototype.hitAD_EB=function(){this.hitTest({formation:HitWorldFormation.army,type:HitWorldType.damage},{formation:HitWorldFormation.enemy,type:HitWorldType.bullet}),this.hitAD_EBTimeout=egret.setTimeout(this.hitAD_EB,this,this.hitDistance)},e.prototype.hitED_AB=function(){this.hitTest({formation:HitWorldFormation.enemy,type:HitWorldType.damage},{formation:HitWorldFormation.army,type:HitWorldType.bullet}),this.hitED_ABTimeout=egret.setTimeout(this.hitED_AB,this,this.hitDistance)},e.prototype.hitAD_ED=function(){this.hitTest({formation:HitWorldFormation.army,type:HitWorldType.damage},{formation:HitWorldFormation.enemy,type:HitWorldType.damage}),this.hitAD_EDTimeout=egret.setTimeout(this.hitAD_ED,this,this.hitDistance)},e.prototype.addObj=function(t){this.addChildAt(t.getDisplay(),0),this.manager[t.getFor()][t.getType()].push(t),t.world=this},e.prototype.removeObj=function(t){t.world=null;var e=this,i=e.manager[t.getFor()][t.getType()],n=i.indexOf(t);i.splice(n,1),this.removeChild(t.getDisplay())},e.prototype.hitTest=function(t,e){var i=this.manager[t.formation][t.type],n=this.manager[e.formation][e.type],o=[].concat.apply([],i.map(function(t){return t.getHitShapes()})),r=[].concat.apply([],n.map(function(t){return t.getHitShapes()}));HitShape.testHits(o,r)},e.prototype.clear=function(){for(var t,e=0,i=this.manager;e<i.length;e++)for(var n=i[e],o=0,r=n;o<r.length;o++){var a=r[o];t=a.slice();for(var s=0,c=t;s<c.length;s++){var h=c[s];h.miss()}}},e.prototype.getInfo=function(t){},e.count=0,e}(egret.DisplayObjectContainer);__reflect(HitWorld.prototype,"HitWorld");var Scence=function(t){function e(){var e=t.call(this)||this;return e.touchers=[],e.childScences=[],e.initial(),e.layout(),e.listen(),e}return __extends(e,t),e.prototype.addTouchListener=function(t,e,i,n){t.addEventListener(e,i,n),this.touchers.push(t)},e.prototype.addScence=function(t,e){return void 0===e&&(e=400),t.alpha=0,this.childScences.push(t),t.prepare(),this.addChild(t),this.childRecord=t,t.parentScence=this,new Promise(function(i){egret.Tween.get(t).to({alpha:1},e).call(function(){t.start(),i()})})},e.prototype.removeScence=function(t,e){var i=this;return void 0===e&&(e=400),t.stop(),new Promise(function(n){egret.Tween.get(t).to({alpha:0},e).call(function(){t.parentScence=null,i.removeChild(t),i.childScences.splice(i.childScences.indexOf(t),1),t.clearChildren(),n()}).to({alpha:1})})},e.prototype.swapScence=function(t,e,i){return void 0===i&&(i=400),this.removeScence(t,i),this.addScence(e,i)},e.prototype.initial=function(){},e.prototype.layout=function(){},e.prototype.listen=function(){},e.prototype.start=function(){this["continue"]();for(var t=0,e=this.touchers;t<e.length;t++){var i=e[t];i.touchEnabled=!0}},e.prototype.stop=function(){this.pause();for(var t=0,e=this.touchers;t<e.length;t++){var i=e[t];i.touchEnabled=!1}},e.prototype.pause=function(){},e.prototype["continue"]=function(){},e.prototype.prepare=function(){},e.prototype.clearChildren=function(){for(var t=0,e=this.childScences;t<e.length;t++){var i=e[t];this.removeChild(i),i.stop(),i.clearChildren()}this.childScences.length=0},e.prototype.update=function(t){},e}(egret.DisplayObjectContainer);__reflect(Scence.prototype,"Scence");var HitModel=function(){function t(t,e){this.type=t,this.set(e)}return t.initial=function(){for(var e=[[HitUtil.hitDotDot,HitUtil.hitDotCircle,HitUtil.hitDotCon],[null,HitUtil.hitCirCir,HitUtil.hitCirCon],[null,null,HitUtil.hitConCon]],i=0;i<e.length;i++){t[i]=[];for(var n=0;n<e.length;n++)t[i][n]=e[i][n]}for(var o=function(i){for(var n=function(n){t[i][n]=function(t,o){return e[n][i].call(null,o,t)}},o=0;i>o;o++)n(o)},i=1;i<e.length;i++)o(i)},t.hitTestModel=function(t,e){return this[t.type][e.type](t.moment,e.moment)},t.hitTestModels=function(e,i){for(var n=!1,o=0,r=e;o<r.length;o++)for(var a=r[o],s=0,c=i;s<c.length;s++){var h=c[s];if(n=t.hitTestModel(a,h))return!0}return!1},t}();__reflect(HitModel.prototype,"HitModel");var IndexAction;!function(t){t[t.INDEX=0]="INDEX",t[t.CERTAIN=1]="CERTAIN",t[t.CHOICE=2]="CHOICE"}(IndexAction||(IndexAction={}));var IndexView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initial=function(){this.content=new egret.DisplayObjectContainer,this.btnChallenge=DisUtil.createBitmap("btn_boss_png"),this.onChoice=new OnChoice},e.prototype.layout=function(){DisUtil.setStandSize(this.content),LayUtil.get(this.content).beCon(),this.addChild(this.content),this.content.addChild(this.btnChallenge),LayUtil.get(this.btnChallenge,this.content).center()},e.prototype.listen=function(){var t=this;this.addTouchListener(this.btnChallenge,egret.TouchEvent.TOUCH_TAP,function(){t.update(IndexAction.CHOICE)},this)},e.prototype.update=function(t){switch(t){case IndexAction.CERTAIN:this.parentScence.update(RouAction.GAME);break;case IndexAction.INDEX:this.removeScence(this.childRecord);break;case IndexAction.CHOICE:this.addScence(this.onChoice)}},e}(Scence);__reflect(IndexView.prototype,"IndexView");var DebugPlatform=function(){function t(){}return t.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,{nickName:"username"}]})})},t.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);var Test=function(){function t(){}return t.hitConCon=function(t,e){var i=new Vector(1,0),n=new Array;for(n.push(HitUtil.support(t,e,i)),i.negate();;){if(n.push(HitUtil.support(t,e,i)),i.dot(n[n.length-1])<=0)return!1;if(HitUtil.conOr(n,i))return!0}},t}();__reflect(Test.prototype,"Test");var DirectHor;!function(t){t[t.LEFT=0]="LEFT",t[t.CENTER=1]="CENTER",t[t.RIGHT=2]="RIGHT"}(DirectHor||(DirectHor={}));var DirectVer;!function(t){t[t.TOP=0]="TOP",t[t.MIDDLE=1]="MIDDLE",t[t.BOTTOM=2]="BOTTOM"}(DirectVer||(DirectVer={}));var RouAction;!function(t){t[t.GAME=0]="GAME",t[t.INDEX=1]="INDEX"}(RouAction||(RouAction={}));var Router=function(t){function e(){var i=t.call(this)||this;return e.INSTANCE=i,i}return __extends(e,t),e.prototype.initial=function(){this.indexView=new IndexView,this.onGame=new OnGame,this.addScence(this.indexView)},e.prototype.update=function(t){switch(t){case RouAction.GAME:if(this.childRecord==this.onGame)return;this.swapScence(this.childRecord,this.onGame);break;case RouAction.INDEX:if(this.childRecord==this.indexView)return;this.swapScence(this.childRecord,this.indexView)}},e}(Scence);__reflect(Router.prototype,"Router");var AnimationBase=function(){function t(t){this.display=t}return t.prototype.getDisplay=function(){return this.display},t.prototype.play=function(t,e,i,n,o){for(var r=this,a=t.x,s=t.y,c=[],h=5;h<arguments.length;h++)c[h-5]=arguments[h];var l={},u={};return c.forEach(function(t){l=__assign({},l,t.endStatus),u=__assign({},u,t.resultStatus)}),DisUtil.location(this.display,a,s),new Promise(function(t){egret.Tween.get(r.display).to(u).to(l,n,o).to(AnimationUnit.reset).call(function(){e.removeChild(r.display),t()}),i==Index.BOTTOM?e.addChildAt(r.display,0):e.addChild(r.display)})},t}();__reflect(AnimationBase.prototype,"AnimationBase");var HitShape=function(){function t(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];this.hitModels=new Array,this.reflector=t,this.hitModels=e}return t.testHits=function(e,i){for(var n=0,o=e;n<o.length;n++)for(var r=o[n],a=0,s=i;a<s.length;a++){var c=s[a];if(!r.reflector.getAlive())break;c.reflector.getAlive()&&t.testHit(r,c)}},t.testHit=function(t,e){if(HitModel.hitTestModels(t.hitModels,e.hitModels)){var i=t.reflector,n=e.reflector;i.hitOther(n),n.hitOther(i)}},t.prototype.getHitModels=function(){return this.hitModels},t.prototype.update=function(t,e){var i=t.x,n=t.y;this.hitModels.forEach(function(t){t.update({x:i,y:n},e)})},t.prototype.updateByCoe=function(t,e){var i=t.x,n=t.y;this.hitModels.forEach(function(t){t.updateByCoe({x:i,y:n},e)})},t.prototype.addUnit=function(t){this.hitModels.push(t)},t.prototype.removeUnit=function(t){this.hitModels.splice(this.hitModels.indexOf(t),1)},t}();__reflect(HitShape.prototype,"HitShape");var AnimationUnit=function(){function t(t,e){this.endStatus=t,this.resultStatus=e}return t.reset={scaleX:1,scaleY:1,rotation:0,alpha:1},t.explode=new t({scaleX:1,scaleY:1},{scaleX:.5,scaleY:.5}),t.fadeIn=new t({alpha:1},{alpha:0}),t.fadeout=new t({alpha:0},{alpha:1}),t.large=new t({scaleX:1.5,scaleY:1.5},{scaleX:1,scaleY:1}),t.mini=new t({scaleX:.5,scaleY:.5},{scaleX:1,scaleY:1}),t}();__reflect(AnimationUnit.prototype,"AnimationUnit");var HitWorldFormation;!function(t){t[t.army=0]="army",t[t.enemy=1]="enemy",t[t.netural=2]="netural"}(HitWorldFormation||(HitWorldFormation={}));var HitWorldType;!function(t){t[t.bullet=0]="bullet",t[t.damage=1]="damage",t[t.netural=2]="netural"}(HitWorldType||(HitWorldType={}));var BitAnimation=function(){function t(t){this.textureName=t;var e=DisUtil.createBitmap(t);DisUtil.anchorCenter(e),this.animationBase=new AnimationBase(e)}return t.prototype.clear=function(){},t.prototype.set=function(){},t.recovery=function(e){t.category[e.textureName]||(t.category[e.textureName]=NorUtil.getStore(t)),t.category[e.textureName].recovery(e)},t.getInstance=function(e){var i=t.category[e];return i&&i.getInstance(e)||new t(e)},t.prototype.playNormal=function(e,i,n,o){var r=this,a=e.x,s=e.y;void 0===o&&(o=Index.BOTTOM);for(var c=[],h=4;h<arguments.length;h++)c[h-4]=arguments[h];(l=this.animationBase).play.apply(l,[{x:a,y:s},i,o,n,null,AnimationUnit.fadeout].concat(c)).then(function(){t.recovery(r)});var l},t.prototype.explodeIn=function(e,i,n){for(var o=this,r=e.x,a=e.y,s=i.width,c=i.height,h=[],l=3;l<arguments.length;l++)h[l-3]=arguments[l];var u=c>s?s:c;u+=5;var p=this.animationBase.getDisplay();DisUtil.size(p,u,u),DisUtil.anchorCenter(p),egret.Tween.get(p).to({x:r,y:a,alpha:1,scaleX:.5,scaleY:.5}).call(function(){n.addChild(p)}).to({scaleX:1,scaleY:1},200*Math.random()+300,egret.Ease.backOut).to({alpha:0},100).call(function(){n.removeChild(p),t.recovery(o)}).to(AnimationUnit.reset)},t.prototype.explodeAround=function(e,i,n){for(var o=e.x,r=e.y,a=i.width,s=i.height,c=[],h=3;h<arguments.length;h++)c[h-3]=arguments[h];var l=s>a?a:s;l+=5;for(var u=3;u--;)t.getInstance(this.textureName).explodeUnit({x:o,y:r},l,n);this.explodeIn({x:o,y:r},{width:a,height:s},n)},t.prototype.explodeUnit=function(t,e,i){for(var n=t.x,o=t.y,r=[],a=3;a<arguments.length;a++)r[a-3]=arguments[a];var s=this.animationBase.getDisplay();DisUtil.size(s,e,e),DisUtil.anchorCenter(s);var c=Math.random()*Math.PI*2,h=e*Math.cos(c),l=e*Math.sin(c);egret.Tween.get(s).to({x:n,y:o,scaleX:1,scaleY:1}).call(function(){i.addChild(s)}).to({scaleX:.5,scaleY:.5,x:n+h,y:o+l},200*Math.random()+300,egret.Ease.quadOut).to({alpha:0},100).call(function(){i.removeChild(s)}).to(AnimationUnit.reset)},t.category=[],t}();__reflect(BitAnimation.prototype,"BitAnimation",["Product"]);var FlyAroundArmy=function(t){function e(e,i){return void 0===i&&(i={timeDistance:2e3,radius:600,angle:2*Math.PI/3}),t.call(this,e,i)||this}return __extends(e,t),e.prototype.setData=function(t){e=[t.timeDistance,t.radius,t.angle],this.timeDistance=e[0],this.radius=e[1],this.angle=e[2],this.baseAngle=(Math.PI-this.angle)/2;var e},e.prototype.start=function(){var t=this;this.onAround(),this.focusTimeout=egret.setTimeout(function(){t.start()},this,this.timeDistance)},e.prototype.stop=function(){egret.clearTimeout(this.focusTimeout),egret.Tween.removeTweens(this.hitObj)},e.prototype.pause=function(){this.stop()},e.prototype["continue"]=function(){this.start()},e.prototype.onAround=function(){var t=this.hitObj.world.manager[HitWorldFormation.army][HitWorldType.damage][0];if(t){var e=(.5*Math.random()+.5)*this.radius,i=Math.random()*this.angle+this.baseAngle,n=Math.PI/2-i,o=t.x+Math.cos(i)*e,r=t.y-Math.sin(i)*e;egret.Tween.removeTweens(this),egret.Tween.get(this.hitObj).to({x:o,y:r},this.timeDistance,egret.Ease.quadInOut),egret.Tween.get(this.hitObj).to({rotation:NorUtil.pIToNum(n)/Math.PI},this.timeDistance,egret.Ease.quadInOut)}},e}(Behavior);__reflect(FlyAroundArmy.prototype,"FlyAroundArmy");var FlyCircle=function(t){function e(e,i){return void 0===i&&(i={centerDot:[0,0],beginAngle:0,totalTime:4e3,radius:100}),t.call(this,e,i)||this}return __extends(e,t),e.prototype.setData=function(e){t.prototype.setData.call(this,e),i=[e.beginAngle,e.totalTime,e.radius,{x:e.centerDot[0],y:e.centerDot[1]}],this.beginAngle=i[0],this.totalTime=i[1],this.radius=i[2],this.centerDot=i[3];var i},Object.defineProperty(e.prototype,"angle",{get:function(){return this._angle},set:function(t){var e=this;e._angle=t,e.hitObj.x=this.centerDot.x+Math.cos(t)*e.radius,e.hitObj.y=this.centerDot.y+Math.sin(t)*e.radius},enumerable:!0,configurable:!0}),e.prototype.start=function(){this.tween=egret.Tween.get(this,{loop:!0}).to({angle:this.beginAngle}).to({angle:this.beginAngle+2*Math.PI},this.totalTime)},e.prototype.pause=function(){egret.Tween.pauseTweens(this)},e.prototype["continue"]=function(){egret.Tween.resumeTweens(this)},e.prototype.stop=function(){egret.Tween.removeTweens(this)},e}(Behavior);__reflect(FlyCircle.prototype,"FlyCircle");var FlyEnd=function(t){function e(e,i){return void 0===i&&(i={speed:2}),t.call(this,e,i)||this}return __extends(e,t),e.prototype.start=function(){var t=this.hitObj,e=this.data.speed,i=-t.size.height/2,n=t.y-i,o=n/e;this.tween=egret.Tween.get(t).to({y:i},o).call(function(){t.miss()})},e.prototype.stop=function(){egret.Tween.removeTweens(this.hitObj)},e.prototype.pause=function(){this.tween.pause()},e.prototype["continue"]=function(){this.tween.play()},e}(Behavior);__reflect(FlyEnd.prototype,"FlyEnd");var FlyToArmy=function(t){function e(e,i){return void 0===i&&(i={speed:.5}),t.call(this,e,i)||this}return __extends(e,t),e.prototype.setData=function(t){this.speed=t.speed},e.prototype.start=function(){var t,e,i,n,o=this,r={x:this.hitObj.x,y:this.hitObj.y},a=this.hitObj.world.manager[HitWorldFormation.army][HitWorldType.damage][0],s={x:a.x,y:a.y},c=this.hitObj.world,h=this.hitObj.size.width/2,l=Line.getLine({x:r.x,y:r.y},s);s.x>r.x?(e=c.width,i=1):(e=0,i=-1);var u,p=l.getY(e);p>=0&&p<=c.height?(e+=h*i,u=l.getY(e)):(u=s.y>r.y?c.height+h:-h,e=l.getX(u)),t=Math.sqrt(Math.pow(e-r.x,2)+Math.pow(u-r.y,2)),n=t/this.speed,this.tween=egret.Tween.get(this.hitObj).to({x:e,y:u},n).call(function(){o.hitObj.miss()})},e.prototype.stop=function(){egret.Tween.removeTweens(this.hitObj)},e.prototype.pause=function(){this.tween.pause()},e.prototype["continue"]=function(){this.tween.play()},e}(Behavior);__reflect(FlyToArmy.prototype,"FlyToArmy");var BulletO1=function(t){function e(i){var n=t.call(this,i)||this;return n.store=e.store,n.type=HitWorldType.bullet,n.size={width:40,height:40},n.aliveDistance=100,i.BehaviorFun||(n.behavior=new FlyToArmy(n,{speed:1})),n.damage=1,n.hitShapes.push(new HitShape(n,new HitCircle({arr:[0,0],radius:n.size.width/2}))),n}return __extends(e,t),e.prototype.initial=function(){var t=DisUtil.createBitmap("o1_dot_around_png");DisUtil.anchorCenter(t),this.display=t},e.prototype.onAlive=function(){var t=this.getWorldDot();BitAnimation.getInstance("o1_dot_shdow_png").playNormal(t.location,this.world,200,Index.BOTTOM,AnimationUnit.mini)},e}(HitObject);__reflect(BulletO1.prototype,"BulletO1");var Light1=function(t){function e(i){var n=t.call(this,i)||this;return n.store=e.getStore(),n.size={width:14,height:41},n.type=HitWorldType.bullet,n.damage=1,n.aliveDistance=15,i.BehaviorFun||(n.behavior=new FlyEnd(n)),n.hitShapes.push(new HitShape(n,new HitConvex([[-n.size.width/2,-n.size.height/2],[n.size.width/2,-n.size.height/2],[n.size.width/2,n.size.height/2],[-n.size.width/2,n.size.height/2]]))),n}return __extends(e,t),e.getStore=function(){var t=e.store;return{recovery:function(e){t.recovery(e)},getInstance:function(e){return t.getInstance(e)}}},e.prototype.set=function(e){t.prototype.set.call(this,e)},e.prototype.initial=function(){var t=DisUtil.createBitmap("nor_png");DisUtil.anchorCenter(t),this.display=t},e.prototype.onAlive=function(){BitAnimation.getInstance("nor_shadow_png").playNormal({x:this.x,y:this.y},this.world,200,Index.BOTTOM,AnimationUnit.mini)},e}(HitObject);__reflect(Light1.prototype,"Light1");var DragControler=function(t){function e(e,i){var n=t.call(this)||this;return n.width=e,n.height=i,n.board=new egret.Shape,n.vector={x:0,y:0},n.pointRecord={x:0,y:0},n.initial(),n.listen(),n}return __extends(e,t),e.prototype.getToucher=function(){return this.board},e.prototype.initial=function(){DisUtil.size(this.board,this.width,this.height);var t=this.board.graphics;t.beginFill(16777215,0),t.drawRect(0,0,this.width,this.height),t.endFill()},e.prototype.listen=function(){this.board.touchEnabled=!0,this.board.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.touchBegin,this),this.board.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.touchMove,this)},e.prototype.getRespond=function(t){this.updateVector()},e.prototype.updateVector=function(){var t=this,e=t.dummys[0];e&&(t.vector={x:e.x-t.pointRecord.x,y:e.y-t.pointRecord.y})},e.prototype.touchBegin=function(t){this.pointRecord={x:t.localX,y:t.localY},this.updateVector()},e.prototype.touchMove=function(t){var e=this;e.pointRecord={x:t.localX,y:t.localY},e.dispatch({x:t.localX+e.vector.x,y:t.localY+e.vector.y})},e.prototype.connect=function(e){t.prototype.connect.call(this,e),this.updateVector()},e}(Controler);__reflect(DragControler.prototype,"DragControler");var DragDummy=function(t){function e(e,i){var n=t.call(this)||this;return n.reflector=e,n.border=i,n}return __extends(e,t),e.prototype.setBorder=function(t){this.border=t},e.prototype.setData=function(e,i,n){t.prototype.setControler.call(this,e),this.reflector=i,this.border=n},e.prototype.update=function(t){var e=t.x,i=t.y;return this.locate(e,i),{x:this.x,y:this.y}},e.prototype.locate=function(t,e){var i=!1,n=this,o=n.border,r=o.top,a=o.right,s=o.bottom,c=o.left;c>t?(t=c,i=!0):t>a&&(t=a,i=!0),r>e?(e=r,i=!0):e>s&&(e=s,i=!0),h=[t,e],this.x=h[0],this.y=h[1];var h},Object.defineProperty(e.prototype,"x",{get:function(){return this.reflector.x},set:function(t){this.reflector.x=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this.reflector.y},set:function(t){this.reflector.y=t},enumerable:!0,configurable:!0}),e}(Dummy);__reflect(DragDummy.prototype,"DragDummy");var LifeDumy=function(t){function e(e){var i=t.call(this)||this;return i.lifeView=e,i}return __extends(e,t),e.prototype.update=function(t){this.lifeView.update(t)},e}(Dummy);__reflect(LifeDumy.prototype,"LifeDumy");var Blue=function(t){function e(i){var n=t.call(this,i)||this;n.store=e.store,n.size={width:111,height:120},n.formation=HitWorldFormation.army,n.type=HitWorldType.damage,n.fireData={0:[15,5,25],1:[5,-5,15],2:[-5,-10,10]},n.status={hor:DirectHor.CENTER,ver:DirectVer.MIDDLE},n.ABLE_DISTANCE=100,n.attackDistance=200,n.gunDistance=e.gunDistance;var o=n.size.width/2,r=n.size.height/2;return n.hitShapes.push(new HitShape(n,new HitConvex([[46,48],[46,35],[66,0],[86,35],[86,48]].map(function(t){return[t[0]-o,t[1]-r]})),new HitConvex([[31,109],[0,95],[0,71],[46,48],[66,48],[132,71],[132,95],[101,109]].map(function(t){return[t[0]-o,t[1]-r]})))),n.layout(),n.changeDisplayHor(n.status.hor),n.changeDisplayVer(n.status.ver),n}return __extends(e,t),e.prototype.getDefaultLife=function(){return 3},e.prototype.getSize=function(){return e.size},e.prototype.set=function(e){t.prototype.set.call(this,e);var i=e.world,n=this.getSize();this.dragDummy=new DragDummy(this),this.dragDummy.setBorder({top:n.height/2,right:i.width-n.width/2,bottom:i.height-n.height/2,left:n.width/2}),DisUtil.location(this.display,i.width/2,i.height-2*n.height)},e.prototype.deCline=function(e){t.prototype.deCline.call(this,e),this.lifeControler.dispatch(this.life)},e.prototype.setDragControler=function(t){this.dragDummy.setControler(t)},e.prototype.initial=function(){this.lifeControler=new Controler;var t=new egret.Sprite;this.display=t;window.innerHeight/window.innerWidth*750;this.leftDisplay=DisUtil.createBitmap("hero_left_png"),this.centerDisplay=DisUtil.createBitmap("hero_center_png"),this.rightDisplay=DisUtil.createBitmap("hero_right_png"),this.fire1=DisUtil.createBitmap("fire1_png"),this.fire2=DisUtil.createBitmap("fire2_png"),this.fire3=DisUtil.createBitmap("fire3_png")},e.prototype.layout=function(){DisUtil.anchorCenter(this.leftDisplay),DisUtil.anchorCenter(this.centerDisplay),DisUtil.anchorCenter(this.rightDisplay),DisUtil.anCenHor(this.fire1),DisUtil.anCenHor(this.fire2),DisUtil.anCenHor(this.fire3),DisUtil.addChildren(this.display,[this.fire1,this.fire2,this.fire3,this.leftDisplay,this.centerDisplay,this.rightDisplay])},e.prototype.changeDisplayHor=function(t){var e=[!1,!1,!1];e[t]=!0,this.leftDisplay.visible=e[0],this.centerDisplay.visible=e[1],this.rightDisplay.visible=e[2]},e.prototype.changeDisplayVer=function(t){var e=this,i=this.fireData[t];[this.fire1,this.fire2].forEach(function(e,n){var o=i[n];egret.Tween.removeTweens(e),egret.Tween.get(e).to({alpha:0},100).to({y:o}).call(function(){egret.Tween.get(e,{loop:!0}).to({alpha:1},100).to({y:o+10+10*n,alpha:0},100+100*t+50*n).to({y:o})})}),egret.Tween.removeTweens(this.fire3);var n=100*t+100;egret.Tween.get(this.fire3).to({alpha:1,y:i[2]},100).call(function(){egret.Tween.get(e.fire3,{loop:!0}).to({alpha:.7},n/2).to({alpha:1},n/2)})},e.prototype.dealDirectionHor=function(t){t!=this.status.hor&&(this.status.hor==t,this.changeDisplayHor(t),this.status.hor=t)},e.prototype.dealDirectionVer=function(t){t!=this.status.ver&&(this.status.ver=t,this.changeDisplayVer(t),this.status.ver=t)},e.prototype.analyseX=function(t){var i=this,n=t-i.x;Math.abs(n)<e.fixNum||(egret.clearTimeout(i.centerHorTimeout),this.dealDirectionHor(n>0?DirectHor.RIGHT:DirectHor.LEFT),i.centerHorTimeout=egret.setTimeout(function(){i.dealDirectionHor(DirectHor.CENTER)
},i,200))},e.prototype.analyseY=function(t){var i=this,n=t-i.y;Math.abs(n)<e.fixNum||(egret.clearTimeout(i.middleVerTimeout),this.dealDirectionVer(0>n?DirectVer.TOP:DirectVer.BOTTOM),i.middleVerTimeout=egret.setTimeout(function(){i.dealDirectionVer(DirectVer.MIDDLE)},i,200))},Object.defineProperty(e.prototype,"x",{get:function(){return this.display.x},set:function(t){this.analyseX(t),this.display.x=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this.display.y},set:function(t){this.analyseY(t),this.display.y=t},enumerable:!0,configurable:!0}),e.prototype.onAttack=function(){var t=this.getWorldDot().location;GameWorld.onFire(t)},e.prototype.connectLifeDummy=function(t){this.lifeControler.connect(t),this.lifeControler.dispatch(this.life)},e.size={width:111,height:120},e.fixNum=10,e.gunDistance=28.5,e}(HitObject);__reflect(Blue.prototype,"Blue");var O1=function(t){function e(i){var n=t.call(this,i)||this;return n.store=e.store,n.type=HitWorldType.damage,n.size={width:200,height:200},n.attackDistance=2e3,n.hitShapes.push(new HitShape(n,new HitCircle({arr:[0,0],radius:n.size.width/2}))),n.layout(),n}return __extends(e,t),e.prototype.getDefaultLife=function(){return 100},e.prototype.initial=function(){this.display=this.wraper=new egret.DisplayObjectContainer,this.base=DisUtil.createBitmap("o1_base_png"),this.eyeL=DisUtil.createBitmap("eye_o1_png"),this.eyeR=DisUtil.createBitmap("eye_o1_png")},e.prototype.layout=function(){DisUtil.anchorCenter(this.base),this.wraper.addChild(this.base),DisUtil.anchorCenter(this.eyeL),DisUtil.location(this.eyeL,-50,50),this.wraper.addChild(this.eyeL),DisUtil.anchorCenter(this.eyeR),DisUtil.location(this.eyeR,50,50),this.wraper.addChild(this.eyeR)},e.prototype.onAlive=function(){var t=this.getWorldDot();BitAnimation.getInstance("o1_png").playNormal(t.location,this.world,500,Index.BOTTOM,AnimationUnit.mini)},e.prototype.beingHit=function(){t.prototype.beingHit.call(this),egret.Tween.removeTweens(this.base),egret.Tween.get(this.base).to({scaleX:1.2,scaleY:1.2},100).to({scaleX:1,scaleY:1},100)},e.prototype.onAttack=function(){if(this.world.manager[HitWorldFormation.army][HitWorldType.damage].length){var t=this.getWorldDot(),e=BulletO1.store.getInstance({formation:this.formation,BehaviorFun:null});e.x=t.location.x,e.y=t.location.y,this.world.addObj(e),e.go()}},e}(HitObject);__reflect(O1.prototype,"O1");var O1Dot=function(t){function e(i){var n=t.call(this,i)||this;return n.store=e.store,n.type=HitWorldType.damage,n.size={width:100,height:100},n.attackDistance=2e3,i.BehaviorFun||(n.behavior=new FlyCircle(n)),n.hitShapes.push(new HitShape(n,new HitCircle({arr:[0,0],radius:n.size.width/2}))),n}return __extends(e,t),e.prototype.getDefaultLife=function(){return 0/0},e.prototype.initial=function(){var t=DisUtil.createBitmap("o1dot_png");DisUtil.anchorCenter(t),this.display=t,this.behavior=new FlyCircle(this)},e.prototype.onAttack=function(){if(this.world.manager[HitWorldFormation.army][HitWorldType.damage].length){var t=this.getWorldDot(),e=BulletO1.store.getInstance({formation:this.formation,BehaviorFun:null});e.x=t.location.x,e.y=t.location.y,this.world.addObj(e),e.go()}},e.prototype.onAlive=function(){var t=this.getWorldDot().location;BitAnimation.getInstance("o1_dot_shdow_png").playNormal(t,this.world,500,Index.BOTTOM,AnimationUnit.mini)},e}(HitObject);__reflect(O1Dot.prototype,"O1Dot");var UnionO=function(t){function e(i){var n=t.call(this,i)||this;return n.store=e.store,n.type=HitWorldType.damage,i.BehaviorFun||(n.behavior=new FlyAroundArmy(n)),n}return __extends(e,t),e.attackOnce=function(t){var i=new e({formation:HitWorldFormation.enemy,BehaviorFun:null});return n=[t.width/2,-200],i.x=n[0],i.y=n[1],t.addObj(i),i.go(),i;var n},e.attack=function(t,i,n){var o;e.attackOnce(t),n>=0&&egret.setTimeout(function(){egret.clearInterval(o)},null,n),o=egret.setInterval(function(){e.attackOnce(t)},null,i)},e.prototype.initialEle=function(){t.prototype.initialEle.call(this);var e=new O1({formation:this.formation,BehaviorFun:null});this.addChild(e),this.heart=e;for(var i=4e3,n=200,o=4;o--;){var r=O1Dot.store.getInstance({formation:this.formation,BehaviorFun:null}),a=Math.PI/2*o;r.x=Math.cos(a)*n,r.y=Math.sin(a)*n,r.behavior.setData({centerDot:[0,0],beginAngle:a,totalTime:i,radius:n}),this.addChild(r)}},e.prototype.getInfo=function(e){t.prototype.getInfo.call(this),e==this.heart&&this.destroy()},e}(HitObjectContainer);__reflect(UnionO.prototype,"UnionO");var Main=function(t){function e(){var e=t.call(this)||this;return Initial(),egret.Bitmap.defaultSmoothing=!1,e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onAddToStage,e),e}return __extends(e,t),e.prototype.onAddToStage=function(t){egret.lifecycle.addLifecycleListener(function(t){t.onUpdate=function(){}}),egret.lifecycle.onPause=function(){egret.ticker.pause()},egret.lifecycle.onResume=function(){egret.ticker.resume()},this.runGame()["catch"](function(t){console.log(t)})},e.prototype.runGame=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return[4,this.loadResource()];case 1:return e.sent(),this.createGameScene(),[4,platform.login()];case 2:return e.sent(),[4,platform.getUserInfo()];case 3:return t=e.sent(),console.log(t),[2]}})})},e.prototype.loadResource=function(){return __awaiter(this,void 0,void 0,function(){var t,e;return __generator(this,function(i){switch(i.label){case 0:return i.trys.push([0,3,,4]),t=new LoadingUI,this.stage.addChild(t),[4,RES.loadConfig("resource/default.res.json","resource/")];case 1:return i.sent(),[4,RES.loadGroup("preload",0,t)];case 2:return i.sent(),this.stage.removeChild(t),[3,4];case 3:return e=i.sent(),console.error(e),[3,4];case 4:return[2]}})})},e.prototype.createGameScene=function(){this.addChild(new Router)},e}(egret.DisplayObjectContainer);__reflect(Main.prototype,"Main");var GameAction;!function(t){t[t.CONTINUE=0]="CONTINUE",t[t.RESTART=1]="RESTART",t[t.BACK_INDEX=2]="BACK_INDEX",t[t.SUCCESS=3]="SUCCESS",t[t.FAIL=4]="FAIL"}(GameAction||(GameAction={}));var OnGame=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.hasResult=!1,e}return __extends(e,t),e.prototype.initial=function(){this.world=new GameWorld(this,DisUtil.STAND_WIDTH,DisUtil.FWH),this.dragControler=new DragControler(this.world.width,this.world.height),this.lifeView=new LifeView,this.btnPause=DisUtil.createBitmap("btn_pause_png"),this.pausePage=new OnPause,this.failPage=new OnFail,this.successPage=new OnSuccess},e.prototype.layout=function(){this.addChild(this.world),this.world.addChild(this.dragControler.getToucher()),LayUtil.get(this.world).fitW().bottom(),this.addChild(this.lifeView),DisUtil.scale(this.lifeView,DisUtil.SA),LayUtil.get(this.lifeView).left().top(),this.addChild(this.btnPause),DisUtil.scale(this.btnPause,DisUtil.SA),LayUtil.get(this.btnPause).right(10*DisUtil.SA).top(10*DisUtil.SA)},e.prototype.listen=function(){var t=this;this.addTouchListener(this.btnPause,egret.TouchEvent.TOUCH_TAP,function(){t.world.pause(),t.addScence(t.pausePage)},this)},e.prototype.start=function(){t.prototype.start.call(this),this.army.setDragControler(this.dragControler),this.army.go(),this.world.startHitTest(),this.boss=e.attackOne(this.world)},e.prototype.prepare=function(){this.army=Blue.store.getInstance({formation:HitWorldFormation.army,BehaviorFun:null,world:this.world}),this.army.connectLifeDummy(this.lifeView.dummy),this.world.addObj(this.army)},e.prototype.update=function(t){var e=this;switch(t){case GameAction.CONTINUE:this.removeScence(this.childRecord,0),this.world["continue"]();break;case GameAction.RESTART:this.world.clear(),this.prepare(),this.removeScence(this.childRecord).then(function(){e.start()});break;case GameAction.BACK_INDEX:this.parentScence.update(RouAction.INDEX);break;case GameAction.FAIL:egret.setTimeout(function(){e.world.stopHitTest()},this,0),this.addScence(this.failPage);break;case GameAction.SUCCESS:this.world.stopHitTest(),this.addScence(this.successPage)}},e.prototype.stop=function(){t.prototype.stop.call(this),this.world.clear(),this.world.stopHitTest()},e.prototype.getInfo=function(t){t==this.army&&this.update(GameAction.FAIL),t==this.boss&&this.update(GameAction.SUCCESS)},e}(Scence);__reflect(OnGame.prototype,"OnGame");var ArmChoicer=function(t){function e(){var e=t.call(this)||this;return e.iconDistance=120,e.initial(),e.layout(),e.choice(0),e}return __extends(e,t),e.getChoiceData=function(){return[["icon_light1_png",GameWorld.light1Fight],["icon_light1_png",GameWorld.light1Fight],["icon_light1_png",GameWorld.light1Fight],["icon_light1_png",GameWorld.light1Fight]]},e.prototype.initial=function(){var t=this;this.iconNames=e.getChoiceData().map(function(t){return t[0]}),this.funs=e.getChoiceData().map(function(t){return t[1]}),this.width=750,this.txt=DisUtil.createBitmap("txt_arm_png"),this.choicer=new IconChoicer(this.iconNames,this.iconDistance,function(e){t.choice(e)},"arm_bg_png"),this.choiceTarget=new egret.Sprite;var i=DisUtil.createBitmap("arrow_left_top_png");DisUtil.location(i,0,0);var n=DisUtil.createBitmap("arrow_right_top_png");DisUtil.location(n,80,0);var o=DisUtil.createBitmap("arrow_right_bottom_png");DisUtil.location(o,80,80);var r=DisUtil.createBitmap("arrow_left_bottom_png");DisUtil.location(r,0,80),this.choiceTarget.anchorOffsetX=this.choiceTarget.anchorOffsetY=65,DisUtil.addChildren(this.choiceTarget,[i,n,o,r])},e.prototype.layout=function(){DisUtil.location(this.txt,70,0),this.addChild(this.txt),DisUtil.location(this.choicer,255,50),this.addChild(this.choicer),DisUtil.location(this.choiceTarget,280,50),this.addChild(this.choiceTarget)},e.prototype.choice=function(t){this.choiceTarget.x=this.choicer.x+this.iconDistance*t,GameWorld.onFire=this.funs[t]},e.prototype.prepare=function(){this.choiceTarget.alpha=1},e.prototype.start=function(){egret.Tween.get(this.choiceTarget,{loop:!0}).to({alpha:.3},500).to({alpha:1},500)},e.prototype.stop=function(){egret.Tween.removeTweens(this.choiceTarget)},e}(egret.Sprite);__reflect(ArmChoicer.prototype,"ArmChoicer");var BossChoicer=function(t){function e(){var e=t.call(this)||this;return e.distance=310,e.initial(),e.layout(),e}return __extends(e,t),e.getBossData=function(){return[["icon_o1_png",UnionO.attackOnce],["icon_o1_png",UnionO.attackOnce],["icon_o1_png",UnionO.attackOnce]]},e.prototype.initial=function(){var t=this;this.iconNames=e.getBossData().map(function(t){return t[0]}),this.funs=e.getBossData().map(function(t){return t[1]}),this.txt=DisUtil.createBitmap("txt_level_png"),this.choicer=new IconChoicer(e.getBossData().map(function(t){return t[0]}),this.distance,function(e){t.choice(e)},"boss_bg_png"),this.cons=this.choicer.conItems},e.prototype.layout=function(){DisUtil.location(this.choicer,375,300),this.cons.forEach(function(t){t.anchorOffsetY=t.height});for(var t=1,e=this.cons.length;e>t;t++)DisUtil.scale(this.cons[t],.7);this.choiceRecord=this.cons[0],this.addChild(this.choicer),DisUtil.location(this.txt,80,0),this.addChild(this.txt)},e.prototype.choice=function(t){egret.Tween.removeTweens(this.choicer),egret.Tween.get(this.choicer).to({x:375-t*this.distance},200,egret.Ease.quadOut),egret.Tween.removeTweens(this.choiceRecord),egret.Tween.get(this.choiceRecord).to({scaleX:.7,scaleY:.7},200,egret.Ease.quadOut),this.choiceRecord=this.cons[t],egret.Tween.removeTweens(this.choiceRecord),egret.Tween.get(this.choiceRecord).to({scaleX:1,scaleY:1},200,egret.Ease.quadOut),OnGame.attackOne=this.funs[t]},e}(egret.Sprite);__reflect(BossChoicer.prototype,"BossChoicer");var GameWorld=function(t){function e(i,n,o){var r=t.call(this,n,o)||this;return r.owner=i,e.world=r,r}return __extends(e,t),e.prototype.getInfo=function(e){t.prototype.getInfo.call(this,e),this.owner.getInfo(e)},e.light1Fight=function(t){var e=Light1.store.getInstance({formation:HitWorldFormation.army,BehaviorFun:null});this.world.addObj(e),n=[t.x+Blue.gunDistance,t.y],e.x=n[0],e.y=n[1],e.go();var i=Light1.store.getInstance({formation:HitWorldFormation.army,BehaviorFun:null});this.world.addObj(i),o=[t.x-Blue.gunDistance,t.y],i.x=o[0],i.y=o[1],i.go();var n,o},e.onFire=e.light1Fight,e}(HitWorld);__reflect(GameWorld.prototype,"GameWorld");var IconChoicer=function(t){function e(e,i,n,o){var r=t.call(this)||this;return r.bgTextureName=o,r.iconNames=e,r.distance=i,r.solveFun=n,r.initial(),r.listen(),r}return __extends(e,t),e.prototype.initial=function(){this.touchItems=[],this.conItems=[];for(var t=0,e=this.iconNames.length;e>t;t++){var i=new egret.DisplayObjectContainer,n=void 0;this.bgTextureName&&(n=DisUtil.createBitmap(this.bgTextureName),i.addChild(n),LayUtil.get(n,i).center());var o=DisUtil.createBitmap(this.iconNames[t]);i.addChild(o),LayUtil.get(o,i).center();var r=n?n:o;r.touchEnabled=!0,this.touchItems.push(r),DisUtil.size(i,r.width,r.height),this.conItems.push(i),DisUtil.anchorCenter(i),DisUtil.location(i,t*this.distance,0),this.addChild(i)}},e.prototype.listen=function(){var t=this;this.addEventListener(egret.TouchEvent.TOUCH_TAP,function(e){var i=t.touchItems.indexOf(e.target);t.solveFun(i)},this)},e}(egret.DisplayObjectContainer);__reflect(IconChoicer.prototype,"IconChoicer");var LifeView=function(t){function e(){var e=t.call(this)||this;return e.items=[],e.initial(),e.layout(),e}return __extends(e,t),e.prototype.initial=function(){this.dummy=new LifeDumy(this),DisUtil.size(this,286,136),this.bg=DisUtil.createBitmap("life_base_png");for(var t=3;t--;)this.items[t]=DisUtil.createBitmap("life_item_png")},e.prototype.layout=function(){var t=this;this.addChild(this.bg);this.items.forEach(function(e,i){DisUtil.location(e,119+45*i,34),t.addChild(e)})},e.prototype.update=function(t){this.items.forEach(function(e,i){egret.Tween.removeTweens(e),egret.Tween.get(e).to({alpha:t>i?1:0},400,egret.Ease.quadOut)})},e}(egret.DisplayObjectContainer);__reflect(LifeView.prototype,"LifeView");var OnChoice=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.initial=function(){this.bg=DisUtil.getRect(DisUtil.STAND_WIDTH,DisUtil.STAND_HEIGHT,0,.7),this.bg.touchEnabled=!0,this.content=new egret.DisplayObjectContainer,DisUtil.setStandSize(this.content),this.btnCertain=DisUtil.createBitmap("btn_certain_png"),this.btnBack=DisUtil.createBitmap("btn_back_png"),this.armsChoice=new ArmChoicer,this.bossChoice=new BossChoicer},e.prototype.layout=function(){this.addChild(this.bg),LayUtil.get(this.bg).cover(),this.addChild(this.content),LayUtil.get(this.content).beCon(),DisUtil.location(this.btnCertain,225,756),this.content.addChild(this.btnCertain),DisUtil.location(this.btnBack,225,900),this.content.addChild(this.btnBack),DisUtil.location(this.armsChoice,0,585),this.content.addChild(this.armsChoice),DisUtil.location(this.bossChoice,0,175.4),this.content.addChild(this.bossChoice)},e.prototype.listen=function(){var t=this;this.addTouchListener(this.btnCertain,egret.TouchEvent.TOUCH_TAP,function(){t.parentScence.update(IndexAction.CERTAIN)},this),this.addTouchListener(this.btnBack,egret.TouchEvent.TOUCH_TAP,function(){t.parentScence.update(IndexAction.INDEX)},this)},e.prototype.prepare=function(){t.prototype.prepare.call(this),this.armsChoice.prepare()},e.prototype.start=function(){t.prototype.start.call(this),this.armsChoice.start()},e.prototype.stop=function(){t.prototype.stop.call(this),this.armsChoice.stop()},e}(Scence);__reflect(OnChoice.prototype,"OnChoice");var OnFail=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.initial=function(){this.blackBg=DisUtil.getRect(DisUtil.STAND_WIDTH,DisUtil.STAND_HEIGHT,0,.7),this.blackBg.touchEnabled=!0,this.content=new egret.DisplayObjectContainer,this.title=DisUtil.createBitmap("txt_fail_png"),this.btnAgain=DisUtil.createBitmap("btn_again_fail_png"),this.btnBackIndex=DisUtil.createBitmap("btn_return_index_fail_png")},e.prototype.layout=function(){DisUtil.setStandSize(this.content),DisUtil.location(this.title,217,366),DisUtil.location(this.btnAgain,225,519),DisUtil.location(this.btnBackIndex,225,663),this.addChild(this.blackBg),this.addChild(this.content),DisUtil.addChildren(this.content,[this.title,this.btnAgain,this.btnBackIndex]),LayUtil.get(this.blackBg).cover(),LayUtil.get(this.content).beCon()},e.prototype.listen=function(){var t=this;this.addTouchListener(this.btnAgain,egret.TouchEvent.TOUCH_TAP,function(){t.parentScence.update(GameAction.RESTART)},this),this.addTouchListener(this.btnBackIndex,egret.TouchEvent.TOUCH_TAP,function(){t.parentScence.update(GameAction.BACK_INDEX)},this)},e}(Scence);__reflect(OnFail.prototype,"OnFail");var OnPause=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.initial=function(){this.blackBg=DisUtil.getRect(DisUtil.STAND_WIDTH,DisUtil.STAND_HEIGHT,0,.7),this.blackBg.touchEnabled=!0,this.btnContinue=DisUtil.createBitmap("btn_continue_png"),this.btnRestart=DisUtil.createBitmap("btn_again_pause_png"),this.btnToIndex=DisUtil.createBitmap("btn_return_index_pause_png"),this.content=new egret.DisplayObjectContainer},e.prototype.layout=function(){this.addChild(this.blackBg),LayUtil.get(this.blackBg).cover(),this.addChild(this.content),DisUtil.setStandSize(this.content),LayUtil.get(this.content).beCon(),DisUtil.addChildren(this.content,[this.btnContinue,this.btnRestart,this.btnToIndex]),DisUtil.location(this.btnContinue,225,380),DisUtil.location(this.btnRestart,225,520),DisUtil.location(this.btnToIndex,225,750)},e.prototype.listen=function(){var t=this;this.addTouchListener(this.btnContinue,egret.TouchEvent.TOUCH_TAP,function(){t.parentScence.update(GameAction.CONTINUE)},this),this.addTouchListener(this.btnRestart,egret.TouchEvent.TOUCH_TAP,function(){t.parentScence.update(GameAction.RESTART)},this),this.addTouchListener(this.btnToIndex,egret.TouchEvent.TOUCH_TAP,function(){t.parentScence.update(GameAction.BACK_INDEX)},this)},e}(Scence);__reflect(OnPause.prototype,"OnPause");var OnSuccess=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.initial=function(){this.blackBg=DisUtil.getRect(DisUtil.STAND_WIDTH,DisUtil.STAND_HEIGHT,0,.7),this.blackBg.touchEnabled=!0,this.content=new egret.DisplayObjectContainer,this.title=DisUtil.createBitmap("success_png"),this.btnAgain=DisUtil.createBitmap("btn_again_fail_png"),this.btnBackIndex=DisUtil.createBitmap("btn_return_index_fail_png")},e.prototype.layout=function(){DisUtil.setStandSize(this.content),DisUtil.location(this.title,217,366),DisUtil.location(this.btnAgain,225,519),DisUtil.location(this.btnBackIndex,225,663),this.addChild(this.blackBg),this.addChild(this.content),DisUtil.addChildren(this.content,[this.title,this.btnAgain,this.btnBackIndex]),LayUtil.get(this.blackBg).cover(),LayUtil.get(this.content).beCon()},e.prototype.listen=function(){var t=this;this.addTouchListener(this.btnAgain,egret.TouchEvent.TOUCH_TAP,function(){t.parentScence.update(GameAction.RESTART)},this),this.addTouchListener(this.btnBackIndex,egret.TouchEvent.TOUCH_TAP,function(){t.parentScence.update(GameAction.BACK_INDEX)},this)},e}(Scence);__reflect(OnSuccess.prototype,"OnSuccess");var AddFilter=function(){function t(){this.customFilter=new egret.CustomFilter(t.vertexSrc,t.fragmentSrc,{customUniform:0})}return t.blingDis=function(e){var i=new egret.CustomFilter(t.vertexSrc,t.fragmentSrc,{customUniform:2*Math.PI});e.filters=[i],egret.Tween.get(i.uniforms,{loop:!0}).to({customUniform:0},1e3).wait(3e3)},t.vertexSrc="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec2 aColor;\nuniform vec2 projectionVector;\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nconst vec2 center = vec2(-1.0, 1.0);\nvoid main(void) {\ngl_Position = vec4( (aVertexPosition / projectionVector) + center , 0.0, 1.0);\nvTextureCoord = aTextureCoord;\nvColor = vec4(aColor.x, aColor.x, aColor.x, aColor.x);\n}",t.fragmentSrc="precision lowp float;\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nuniform sampler2D uSampler;\nuniform float customUniform;\nvoid main(void) {\nvec2 uvs = vTextureCoord.xy;\nvec4 fg = texture2D(uSampler, vTextureCoord);\nfg.rgb += sin(customUniform + uvs.x * 2. + uvs.y * 2.) * 0.2;\ngl_FragColor = fg * vColor;\n}",t}();__reflect(AddFilter.prototype,"AddFilter");var ArrUtil=function(){function t(){}return t.scale=function(e,i){for(var n,o=e.length,r=0;o>r;r++)n=e[r],n instanceof Array?t.scale(n,i):e[r]*=i},t}();__reflect(ArrUtil.prototype,"ArrUtil");var ColorFilter=function(){function t(){}return t.initial=function(){this.norFilter=new egret.ColorMatrixFilter(t.norMatrix),this.redFilter=new egret.ColorMatrixFilter(t.redMatrix),this.greenFilter=new egret.ColorMatrixFilter(t.greenMatrix),this.blueFilter=new egret.ColorMatrixFilter(t.blueMatrix)},t.redFlash=function(e,i){void 0===i&&(i=100),e.filters=[t.redFilter],egret.setTimeout(function(){e.filters=[]},null,i)},t.greenFlash=function(e,i){void 0===i&&(i=100),e.filters=[t.greenFilter],egret.setTimeout(function(){e.filters=[]},null,i)},t.blueFlash=function(e,i){void 0===i&&(i=100),e.filters=[t.blueFilter],egret.setTimeout(function(){e.filters=[]},null,i)},t.norMatrix=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],t.redMatrix=[1,0,0,0,255,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],t.greenMatrix=[1,0,0,0,0,0,1,0,0,255,0,0,1,0,0,0,0,0,1,0],t.blueMatrix=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,255,0,0,0,1,0],t}();__reflect(ColorFilter.prototype,"ColorFilter");var DisUtil=function(){function t(){}return t.initial=function(){var e=document.getElementsByClassName("egret-player")[0];t.STAND_WIDTH=+e.getAttribute("data-content-width"),t.STAND_HEIGHT=+e.getAttribute("data-content-height");var i=window.innerWidth,n=window.innerHeight,o=n/i,r=t.STAND_HEIGHT/t.STAND_WIDTH;t.FW=i/t.STAND_WIDTH,t.FH=n/t.STAND_HEIGHT,r>o?(a=[t.FH,t.FW],t.SA=a[0],t.CA=a[1]):(s=[t.FW,t.FH],t.SA=s[0],t.CA=s[1]),t.FHW=t.STAND_HEIGHT/o,t.FWH=t.STAND_WIDTH*o;var a,s},t.setStandSize=function(e){t.size(e,t.STAND_WIDTH,t.STAND_HEIGHT)},t.createBitmap=function(t){var e=RES.getRes(t),i=new egret.Bitmap;return i.texture=e,i},t.getRect=function(e,i,n,o){void 0===o&&(o=1);var r=new egret.Shape;t.size(r,e,i);var a=r.graphics;return a.beginFill(n,o),a.drawRect(0,0,e,i),a.endFill(),r},t.size=function(t,e,i){t.width=e,t.height=i},t.location=function(t,e,i){t.x=e,t.y=i},t.anchorCenter=function(t){t.anchorOffsetX=t.width/2,t.anchorOffsetY=t.height/2},t.anCenHor=function(t){t.anchorOffsetX=t.width/2},t.anCenVer=function(t){t.anchorOffsetY=t.height/2},t.addChildren=function(t,e){e.forEach(function(e){t.addChild(e)})},t.scale=function(t,e){t.scaleX=t.scaleY=e},t.setProps=function(t,e){for(var i in e)t.forEach(function(t){t[i]=e[i]})},t.show=function(t){egret.log("x: "+t.x+"\n			y: "+t.y+"\n			width: "+t.width+"\n			height: "+t.height+"\n			scaleX: "+t.scaleX+"\n			scaleY: "+t.scaleY+"\n			rotation: "+t.rotation)},t.createBlingMap=function(e){var i=new egret.Sprite,n=new egret.Sprite,o=t.createBitmap(e);AddFilter.blingDis(o),n.addChild(o);var r=t.createBitmap(e);return i.addChild(n),i.addChild(r),n.mask=r,t.size(i,o.width,o.height),i},t}();__reflect(DisUtil.prototype,"DisUtil");var DraUtil=function(){function t(){}return t.getCloLine=function(t,e){var i=new egret.Shape,n=i.graphics,o=e||[1,0];(h=n.lineStyle).call.apply(h,[n].concat(o));var r,a=1,s=t.length,c=t[0];for(n.moveTo(c.x,c.y);s>a;)r=t[a],n.lineTo(r.x,r.y),a++;return n.lineTo(c.x,c.y),i;var h},t.getPoArr=function(t){for(var e,i=t.length,n=0,o=[];i>n;)e=t[n],o.push(new Vector(e[0],e[1])),n++;return o},t.getGrd=function(e,i,n,o,r,a){var s=new egret.Shape;s.width=e,s.height=i,r=r||20,a=a||20,n=n||0,o=o||16777215;var c=s.graphics;c.beginFill(n);var h=Math.floor(i/a),l=Math.floor(e/r),u=e-l*r,p=i-h*a;t.draColGrid(n,c,0,l,h,r,a,u,p,h%2),t.draColGrid(o,c,1,l,h,r,a,u,p,(h+1)%2);var d=Math.abs(l-h)%2==0?n:o;return c.drawRect(l*r,h*a,0,0),c.beginFill(d),c.drawRect(l*r,h*a,u,p),s},t.draColGrid=function(e,i,n,o,r,a,s,c,h,l){var u=0;i.beginFill(e);for(var p=0;o>p;p++,u+=a,n=n?0:1)t.drawGridLineVer(i,a,s,n,r,u);0!=c&&t.drawGridLineVer(i,c,s,n,r,u),0!=h&&t.drawGridLineHor(i,a,h,l,o,r*s)},t.drawGridLineVer=function(t,e,i,n,o,r){for(var a=n*i,s=2*i,c=n;o>c;c+=2)t.drawRect(r,a,e,i),a+=s},t.drawGridLineHor=function(t,e,i,n,o,r){for(var a=n*e,s=2*e,c=n;o>c;c+=2)t.drawRect(a,r,e,i),a+=s},t.fillGrid=function(e,i,n,o,r,a){var s=t.getGrd(e.width,e.height,n,o,r,a);i=0==i?0:i?i:1,s.alpha=i,e.addChild(s)},t.drawTansBg=function(t){var e=new egret.Shape;n=[t.width,t.height],e.width=n[0],e.height=n[1];var i=e.graphics;i.beginFill(16777215,0),i.drawRect(0,0,e.width,e.height),i.endFill(),t.addChildAt(e,0);var n},t}();__reflect(DraUtil.prototype,"DraUtil");var LayUtil=function(){function t(){}return t.size=function(t,e,i){t.width=e,t.height=i},t.ancho=function(t,e,i){t.anchorOffsetX=e,t.anchorOffsetY=i},t.getDisCon=function(t){var e=new egret.DisplayObjectContainer;return NorUtil.set(e,t),e},t.getGridCon=function(t,e,i){var n=new egret.DisplayObjectContainer;return NorUtil.set(n,t),DraUtil.fillGrid(n,e,i),n},t.location=function(t,e,i){t.x=e,t.y=i},t.getCloneBase=function(e){var i=new egret.DisplayObject;return t.location(i,0,0),t.size(i,e.width,e.height),i},t.getRelaRect=function(e,i){var n=t.getCloneBase(e);return n=t.getInRectRelaRect(n,e,i)},t.getInRectRelaRect=function(t,e,i){for(var n,o,r,a;e!=i;)egret.is(e,"egret.Stage")?(n=0,o=0,r=1,a=1):(n=e.x,o=e.y,r=e.scaleX,a=e.scaleY),t.x=n+(t.x-e.anchorOffsetX)*r,t.y=o+(t.y-e.anchorOffsetY)*a,t.width*=r,t.height*=a,e=e.parent;return t},t.get=function(e,i){var n=t.getRelaRect(e,i);return new situate(n,e,i)},t.setScal=function(t,e){t.scaleX=t.scaleY=e},t.scale=function(t,e){t.scaleX*=e,t.scaleY*=e},t.scalLen=function(t,e){t.width*=e,t.height*=e},t.disShow=function(t,e){e=e?e:1,console.log("x:"+t.x.toFixed(e)+",y:"+t.y.toFixed(e)+",anchorOffsetX:"+t.anchorOffsetX.toFixed(e)+",anchorOffsetY:"+t.anchorOffsetY.toFixed(e)+",scaleX:"+t.scaleX.toFixed(e)+",scaleY:"+t.scaleY.toFixed(e)+",width:"+t.width.toFixed(e)+",height:"+t.height.toFixed(e)+",alpha:"+t.alpha)},t}();__reflect(LayUtil.prototype,"LayUtil");var situate=function(){function t(t,e,i){this.relRect=t,this.disObj=e,this.ancient=i,i?(this.conWidth=i.width,this.conHeight=i.height):(this.conWidth=window.innerWidth,this.conHeight=window.innerHeight),this.anRateX=e.anchorOffsetX/e.width,this.anRateY=e.anchorOffsetY/e.height}return t.prototype.scale=function(t){var e=this,i=this.anRateX*(t-1)*e.relRect.width,n=this.anRateY*(t-1)*e.relRect.height;LayUtil.scale(e.disObj,t),LayUtil.scalLen(e.relRect,t),e.relRect.x-=i,e.relRect.y-=n},t.prototype.moveX=function(t,e){var i=this;i.relRect.x+=t,i.disObj.x+=t*=e},t.prototype.moveY=function(t,e){var i=this;i.relRect.y+=t,i.disObj.y+=t*=e},t.prototype.fitW=function(){var t=this;if(0==t.relRect.width)return egret.error("宽度为0的显示对象无法应用“适应宽度”的缩放模式"),this;var e=t.conWidth/t.relRect.width;return t.scale(e),t.cenHor(),t},t.prototype.fitH=function(){var t=this;if(0==t.relRect.height)return egret.error("高度为0的显示对象无法应用“适应高度”的缩放模式"),this;var e=t.conHeight/t.relRect.height;return t.scale(e),t.cenVer(),t},t.prototype.beCon=function(){var t=this,e=t.conWidth/t.conHeight,i=t.relRect.width/t.relRect.height,n=i>=e?t.conWidth/t.relRect.width:t.conHeight/t.relRect.height;return t.scale(n),t.center(),this},t.prototype.cover=function(){var t=this,e=t.conWidth/t.conHeight,i=t.relRect.width/t.relRect.height,n=i>=e?t.conHeight/t.relRect.height:t.conWidth/t.relRect.width;return t.scale(n),t.center(),this},t.prototype.center=function(){return this.cenVer(),this.cenHor(),this},t.prototype.cenVer=function(){var t=this,e=t.conHeight/2-t.relRect.y-t.relRect.height/2,i=t.disObj.height*t.disObj.scaleY/t.relRect.height;return t.moveY(e,i),t},t.prototype.cenHor=function(){var t=this,e=t.conWidth/2-t.relRect.x-t.relRect.width/2,i=t.disObj.width*t.disObj.scaleX/t.relRect.width;return t.moveX(e,i),t},t.prototype.left=function(t){t=null==t?0:t;var e=this,i=e.disObj.width*e.disObj.scaleX/e.relRect.width,n=t-e.relRect.x;return e.moveX(n,i),this},t.prototype.right=function(t){var e=this;t=null==t?0:t;var i=e.disObj.width*e.disObj.scaleX/e.relRect.width,n=e.conWidth-e.relRect.x-e.relRect.width-t;return e.moveX(n,i),this},t.prototype.top=function(t){t=null==t?0:t;var e=this,i=e.disObj.height*e.disObj.scaleY/e.relRect.height,n=t-e.relRect.y;return e.moveY(n,i),this},t.prototype.bottom=function(t){t=null==t?0:t;var e=this;t=null==t?0:t;var i=e.disObj.height*e.disObj.scaleY/e.relRect.height,n=e.conHeight-e.relRect.y-e.relRect.height-t;return e.moveY(n,i),this},t.prototype.show=function(t){t=t?t:1;var e=this.relRect;return console.log("x:"+e.x.toFixed(t)+",y:"+e.y.toFixed(t)+",width:"+e.width.toFixed(t)+",height:"+e.height.toFixed(t)),this},t}();__reflect(situate.prototype,"situate");var Line=function(){function t(t,e){this.k=t,this.b=e}return t.prototype.getY=function(t){return isNaN(this.k)&&egret.warn("斜率不为数字"),this.k*t+this.b},t.prototype.getX=function(t){return 0==this.k&&egret.warn("斜率为0"),isNaN(this.k)?this.b:(t-this.b)/this.k},t.getLine=function(e,i){var n=Matrix.undo([[e.x,1,-e.y],[i.x,1,-i.y]]);if(null==n)var o=[0/0,e.x],r=o[0],a=o[1];else var r=n[0],a=n[1];return new t(r,a)},t}();__reflect(Line.prototype,"Line");var Matrix=function(){function t(){}return t.scale=function(t,e){return t.map(function(t){return t*e})},t.sub=function(t,e){for(var i=[],n=0,o=t.length;o>n;n++)i[n]=t[n]-e[n];return i},t.add=function(t,e){for(var i=[],n=0,o=t.length;o>n;n++)i[n]=t[n]+e[n];return i},t.undo=function(e){for(var i=[],n=0;0==e[0][0];){if(n++,n==e.length)return null;e.push(e.splice(0,1)[0])}e[0]=t.scale(e[0],1/e[0][0]);for(var o=1,r=e.length;r>o;o++){for(var a=0;o>a;a++)0!=e[o][a]&&(e[o]=t.scale(e[o],1/e[o][a]),e[o]=t.sub(e[o],e[a]));if(0==e[o][a]){for(var s=0,c=r-o+1;0==e[o][a];){if(s++,s==c)return null;e.push(e.splice(o,1)[0])}o--}else e[o]=t.scale(e[o],1/e[o][a])}for(var o=e.length-1;o>=0;o--)for(var h=0;o>h;h++)e[h]=t.sub(e[h],t.scale(e[o],e[h][o]));for(var o=0,r=e.length;r>o;o++)i[o]=-e[o][r];return i},t}();__reflect(Matrix.prototype,"Matrix");var Index;!function(t){t[t.TOP=0]="TOP",t[t.BOTTOM=1]="BOTTOM"}(Index||(Index={}));var HitType;!function(t){t[t.DOT=0]="DOT",t[t.CIRCLE=1]="CIRCLE",t[t.CONVEX=2]="CONVEX"}(HitType||(HitType={}));var HitUtil=function(){function t(){}return t.hitDotDot=function(t,e){return t.x==e.x&&t.y==e.y},t.hitDotCircle=function(t,e){var i=Math.sqrt(Math.pow(t.x-e.dot.x,2)+Math.pow(t.y-e.dot.y,2));return i<e.radius},t.hitDotCon=function(e,i){var n=new Vector(1,0);i=i.map(function(t){return new Vector(t.x-e.x,t.y-e.y)});var o=new Array,r=t.getFar(i,n);for(o.push(r),n.negate();;){if(r=t.getFar(i,n),o.push(r),n.dot(o[o.length-1])<=0)return!1;if(t.conOr(o,n))return!0}},t.hitCirCir=function(t,e){var i=Math.sqrt(Math.pow(t.dot.x-e.dot.x,2)+Math.pow(t.dot.y-e.dot.y,2));return i<t.radius+e.radius},t.hitCirCon=function(e,i){var n=new Vector(1,0),o=new Array;for(o.push(t.supportCirCon(e,i,n)),n.negate();;){if(o.push(t.supportCirCon(e,i,n)),n.dot(o[o.length-1])<=0)return!1;if(t.conOr(o,n))return!0}},t.hitConCon=function(e,i){var n=new Vector(1,0),o=new Array;for(o.push(t.support(e,i,n)),n.negate();;){if(o.push(t.support(e,i,n)),n.dot(o[o.length-1])<=0)return!1;if(t.conOr(o,n))return!0}},t.support=function(e,i,n){var o=t.getFar(e,n);n.negate();var r=t.getFar(i,n);return n.negate(),new Vector(o.x-r.x,o.y-r.y)},t.supportCirCon=function(e,i,n){var o=Math.sqrt(Math.pow(n.x,2)+Math.pow(n.y,2)),r=e.radius/o,a={x:e.dot.x+n.x*r,y:e.dot.y+n.y*r};n.negate();var s=t.getFar(i,n);return n.negate(),new Vector(a.x-s.x,a.y-s.y)},t.conOr=function(t,e){var i,n,o,r,a,s,c=t.length,h=t[c-1],l=h.getNeg();if(3==c)if(i=t[c-2],n=t[c-3],o=Vector.getVec(h,i),r=Vector.getVec(h,n),a=Vector.tripleProduct(r,o,o),s=Vector.tripleProduct(o,r,r),a.dot(l)>0)t.shift(),e.copy(a);else{if(!(s.dot(l)>0))return!0;t.splice(1,1),e.copy(s)}else{if(i=t[c-2],o=Vector.getVec(h,i),a=Vector.tripleProduct(o,l,o),0===a.x&&0===a.y)return!0;e.copy(a)}return!1},t.getFar=function(t,e){var i,n,o=0,r=t.length,a=0,s=e.dot(t[o]);
for(o++;r>o;){if(i=e.dot(t[o]),i>s)s=i,a=o,n=!0;else if(n)break;o++}return t[a]},t}();__reflect(HitUtil.prototype,"HitUtil");var Vector=function(t){function e(e,i){return t.call(this,e,i)||this}return __extends(e,t),e.getVectors=function(t){var i=new Array;return t.forEach(function(t){i.push(new e(t[0],t[1]))}),i},e.prototype.copy=function(t){e=[t.x,t.y],this.x=e[0],this.y=e[1];var e},e.prototype.negate=function(){t=[-this.x,-this.y],this.x=t[0],this.y=t[1];var t},e.prototype.getNeg=function(){return new e(-this.x,-this.y)},e.prototype.dot=function(t){return this.x*t.x+this.y*t.y},e.prototype.scale=function(t){this.x*=t,this.y*=t},e.prototype.getScale=function(t){return new e(this.x*t,this.y*t)},e.prototype.getRotate=function(t){if(0==t)return this;var i=Math.cos(t),n=Math.sin(t),o=this;return t>0?new e(i*o.x+n*o.y,-n*o.x+i*o.y):new e(i*o.x-n*o.y,n*o.x+i*o.y)},e.getVec=function(t,i){return new e(i.x-t.x,i.y-t.y)},e.tripleProduct=function(t,i,n){return e.getVec(t.getScale(i.dot(n)),i.getScale(t.dot(n)))},e}(egret.Point);__reflect(Vector.prototype,"Vector");var HitCircle=function(t){function e(e){var i=t.call(this,HitType.CIRCLE,e)||this;return i.set(e),i}return __extends(e,t),e.prototype.set=function(t){this.data={dot:new egret.Point(t.arr[0],t.arr[1]),radius:t.radius},this.moment={dot:new Vector(t.arr[0],t.arr[1]),radius:t.radius}},e.prototype.update=function(t,e){var i=t.x,n=t.y,o=NorUtil.getRotate(this.data.dot,e);this.moment.dot.setTo(i+o.x,n+o.y)},e.prototype.updateByCoe=function(t,e){var i=t.x,n=t.y,o=e.getCoeResult(this.data.dot);this.moment.dot.setTo(i+o.x,n+o.y)},e}(HitModel);__reflect(HitCircle.prototype,"HitCircle");var HitConvex=function(t){function e(e){return t.call(this,HitType.CONVEX,e)||this}return __extends(e,t),e.prototype.set=function(t){var e=this;this.data=new Array,this.moment=new Array,t.forEach(function(t){e.data.push(new egret.Point(t[0],t[1])),e.moment.push(new Vector(t[0],t[1]))})},e.prototype.update=function(t,e){var i=this,n=t.x,o=t.y;this.moment.forEach(function(t,r){var a=i.data[r],s=NorUtil.getRotate({x:a.x,y:a.y},e);t.setTo(n+s.x,o+s.y)})},e.prototype.updateByCoe=function(t,e){var i=this,n=t.x,o=t.y;this.moment.forEach(function(t,r){var a=i.data[r],s=e.getCoeResult({x:a.x,y:a.y});t.setTo(n+s.x,o+s.y)})},e}(HitModel);__reflect(HitConvex.prototype,"HitConvex");var HitDot=function(t){function e(e){return t.call(this,HitType.DOT,e)||this}return __extends(e,t),e.prototype.set=function(t){this.data=new egret.Point(t[0],t[1]),this.moment=new Vector(t[0],t[1])},e.prototype.update=function(t,e){var i=t.x,n=t.y,o=NorUtil.getRotate({x:this.data.x,y:this.data.y},e);this.moment.setTo(i+o.x,n+o.y)},e.prototype.updateByCoe=function(t,e){var i=t.x,n=t.y,o=e.getCoeResult({x:this.data.x,y:this.data.y});this.moment.setTo(i+o.x,n+o.y)},e}(HitModel);__reflect(HitDot.prototype,"HitDot");var LoadingUI=function(t){function e(){var e=t.call(this)||this;return e.createView(),e}return __extends(e,t),e.prototype.createView=function(){DisUtil.setStandSize(this),LayUtil.get(this).beCon(),this.textField=new egret.TextField,this.addChild(this.textField),this.textField.textColor=16777215,this.textField.text="Loading...",this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.size=40,this.textField.textAlign="center",LayUtil.get(this.textField,this).center()},e.prototype.onProgress=function(t,e){this.textField.text="Loading..."+Math.ceil(t/e*100)+"%"},e}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI",["RES.PromiseTaskReporter"]);var NorUtil=function(){function t(){}return t.set=function(t,e){for(var i in e)t[i]=e[i]},t.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=t.map(function(t){return JSON.stringify(t)});console.log.apply(console,[""].concat(i))},t.getRotate=function(e,i){var n=e.x,o=e.y;if(0==i)return{x:n,y:o};i=t.numToPI(i);var r=Math.cos(i),a=Math.sin(i);return{x:r*n+a*o,y:-a*n+r*o}},t.getRotateRe=function(e,i){var n=e.x,o=e.y;if(0==i)return{x:n,y:o};i=t.numToPI(i);var r=Math.cos(i),a=Math.sin(i);return{x:r*n-a*o,y:a*n+r*o}},t.getRotateCoe=function(e){e=t.numToPI(e);var i=Math.cos(e),n=Math.sin(e);e=t.numToPI(e);var o={xCoe:{xMul:i,yMul:n},yCoe:{xMul:n,yMul:i}};return o.yCoe.xMul=-n,new RotationCoe(new RotationUnitCoe(o.xCoe.xMul,o.xCoe.yMul),new RotationUnitCoe(o.yCoe.xMul,o.yCoe.yMul))},t.getRotateCoeRe=function(e){e=t.numToPI(e);var i=Math.cos(e),n=Math.sin(e);e=t.numToPI(e);var o={xCoe:{xMul:i,yMul:n},yCoe:{xMul:n,yMul:i}};return o.xCoe.yMul=-n,new RotationCoe(new RotationUnitCoe(o.xCoe.xMul,o.xCoe.yMul),new RotationUnitCoe(o.yCoe.xMul,o.yCoe.yMul))},t.getStore=function(t){function e(){return o.length}function i(t){t.clear(),o.push(t)}function n(e){var i=o.pop();return i?(i.set(e),i):new t(e)}var o=new Array;return{recovery:i,getInstance:n,getCount:e}},t.numToPI=function(t){return t/180*Math.PI},t.pIToNum=function(t){return 180*t/Math.PI},t}();__reflect(NorUtil.prototype,"NorUtil");var RotationUnitCoe=function(){function t(t,e){this.xMul=t,this.yMul=e}return t.prototype.getCoeResult=function(t){var e=t.x,i=t.y;return e*this.xMul+i*this.yMul},t}();__reflect(RotationUnitCoe.prototype,"RotationUnitCoe");var RotationCoe=function(){function t(t,e){this.xCoe=t,this.yCoe=e}return t.prototype.getCoeResult=function(t){var e=t.x,i=t.y;return{x:this.xCoe.getCoeResult({x:e,y:i}),y:this.yCoe.getCoeResult({x:e,y:i})}},t}();__reflect(RotationCoe.prototype,"RotationCoe");